;========================================
; Script Name: Automated Blade Pre-Poisoning
; Author: Janus
; Version: 1.0
; Client Tested with: 4.0.3e client
; EUO version tested with: 1.42 B0096
; Shard OSI / FS: Local POL
; Revision Date: 10-30-04
; Public Release: 10-30-04
; Purpose: poisons all items in a specified container
;========================================
display ok target the bag and lean back.
set %fail 0
set %trys 0
event macro 13 3
target 60s
waitfornotarget:
if #targcurs = 0 2
set %bag #ltargetid
goto next
goto waitfornotarget
next:
set #lobjectid %bag
event macro 17 0
event sysmessage didum...few seconds left to wait from the last action...
wait 9s
finditem * C_ , %bag
set %if #findcnt
for %items 1 #findcnt
{
set %trys %trys + 1
start:
finditem AVF
set %poisonpotions #findcnt
if #findkind = -1
goto end
set #ltargetkind 1
event macro 13 30
target 10s
set #ltargetid #findid
event macro 22 0
set %timeout #scnt + 5
wait:
if #scnt >= %timeout 2
key esc
goto start
if #targcurs = 0
goto wait
target 10s
tryagain:
finditem * %items C_ , %bag
set #ltargetid #findid
event macro 22 0
set %timeout #scnt + 5
wait2:
if #scnt >= %timeout
goto tryagain
if #targcurs <> 0
goto wait2
wait 10
if you_fail in #journal || you_fail in #sysmsg 2
set %fail %fail + 1
set %items %items - 1
wait 180
}
set %items %items - 1
display ok done!$Items poisoned: %items $Poison Potions
+left %poisonpotions $Try's %trys $Fails: %fail
halt
end:
display ok out of %if Items in the Bag i poisoned %items until i
+went out of poison potions.$Try's %trys $Fails: %fail
halt