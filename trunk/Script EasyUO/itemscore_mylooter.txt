  set %value 0
  set %number1 0
  finditem %object C_ , %body
  if #findkind = -1
  {
    EXIT
  }
  if #findtype notin %armor && #findtype notin %jewelery && #findtype notin %weapon && #findtype notin %shields && #findtype notin %instruments
  {
    EXIT
  }

  
  linespercycle 80
  set %resist 0
  set %value 0

  event property #findid
  set %value 0
  finditem %object C_ , %body

  if #findtype in %weapon
    gosub HandleCheck weapon

  if #findtype in %shields
    gosub HandleCheck shields

  if #findtype in %armor
    gosub HandleCheck armor

  if #findtype in %jewelery 
    gosub HandleCheck jewelery

  if #findtype in %instruments
    gosub HandleCheck instrument

  event SysMessage Completed Property Check
  linespercycle 10
  EXIT

  sub HandleCheck
  set %my_check_type %1
  gosub %1
  event SysMessage %my_check_type found. Value is %value
  return

  sub jewelery
  gosub skill
  gosub stats
  gosub chanceIncrease
  gosub damageIncrease
  gosub luck
  gosub night
  gosub fastercast
  gosub resist
  gosub LRC
  return

  sub skill
  if %lootskill = #false
    return
  if animal , #spc , taming notin #property 2
    set %number1 0
  else
    gosub property a b animal , #spc , taming
  set %value %value + %number1
  if healing notin #property 2
    set %number1 0
  else
    gosub property a b healing 
  set %value %value + %number1
  if magery notin #property 2
    set %number1 0
  else
    gosub property a b magery
  set %value %value + %number1
  if resist notin #property 2
    set %number1 0
  else
    gosub property a b resist
  set %value %value + %number1
  return

  sub fastercast
  if %lootfcr = #false
    return
  if cast , #spc , recovery notin #property 2
    set %number1 0
  else
    gosub property a b cast , #spc , recovery
  set %value %value + ( %number1 * 2 )
  if faster , #spc , casting in #property
    set %value %value + 2
  if (faster , #spc , casting in #property) &&  (cast , #spc , recovery in #property)
    set %value %value + 5
  return

  sub stats
  if %lootstat = #false
    return
  if intelligence , #spc , bonus notin #property 2
    set %number1 0
  else
    gosub property a b intelligence , #spc , bonus
  set %value %value + ( %number1 / 3 )
  if strength , #spc , bonus notin #property 2
    set %number1 0
  else
    gosub property a b strength , #spc , bonus
  set %value %value + ( %number1 / 3 )
  if dexterity , #spc , bonus notin #property 2
    set %number1 0
  else
    gosub property a b dexterity , #spc , bonus
  set %value %value + ( %number1 / 3 ) 
  return

  sub night
  if %lootnight = #false
    return
  if night in #property
    set %value %value + 1
  return

  sub armor
  gosub regeneration
  gosub resist
  gosub LRC
  gosub luck
  gosub selfRepair
  gosub mage
  return


  sub selfRepair
  if %lootrepair = #false
    return
  if self , #spc , repair notin #property 2
    set %number1 0
  else
    gosub property a b self , #spc , repair
  set %value %value + ( %number1 / 2 )
  return


  sub LRC
  if %lootlrc = #false
    return
  if lower , #spc , reagent , #spc , cost notin #property
    return
  gosub property a b lower , #spc , reagent , #spc , cost
  if %number1 > 10
    set %value %value + ( %number1 / 2 ) + 2
  return


  sub regeneration
  if %lootregen = #false
    return
  if mana , #spc , regeneration notin #property 2
    set %number1 0
  else
    gosub property a b mana , #spc , regeneration 
  set %value %value + %number1
  if hit , #spc , point , #spc , regeneration notin #property 2
    set %number1 0
  else
    gosub property a b hit , #spc , point , #spc , regeneration
  set %value %value + %number1
  return

  sub mage
  if %lootmage = #false
    return
  if mage , #spc , armor in #property
    set %value %value + 7
  if mage , #spc , weapon in #property
    set %value %value + 2
  return

  sub weapon
  gosub chanceIncrease
  gosub damageIncrease
  gosub speedIncrease
  gosub channeling
  gosub slayer
  gosub leech
  gosub lower
  gosub spellChance
  gosub bestWeapon
  gosub luck
  gosub mage
  gosub selfRepair
  return

  sub shields
  gosub chanceIncrease
  gosub damageIncrease
  gosub speedIncrease
  gosub channeling
  gosub leech
  gosub lower
  gosub luck
  gosub mage
  gosub resist
  gosub selfRepair
  return

  sub instrument
  gosub slayer
  return

  sub slayer
  if %lootslayer = #false
    return
  if slayer in #property
    set %value %value + 3
  if ( dragon in #property || daemon in #property ) || ( repond in #property || undead in #property )
    set %value %value + 4
  return

  sub spellChance
  if %lootspell = #false
    return
  if hit , #spc , lightning notin #property 3
    set %number1 0
  else
    gosub property a b hit , #spc , lightning
  set %value %value + ( %number1 / 3 )
  if hit , #spc , harm notin #property 3
    set %number1 0
  else
    gosub property a b hit , #spc , harm
  set %value %value + ( %number1 / 3 )
  if hit , #spc , fireball notin #property 3
    set %number1 0
  else
    gosub property a b hit , #spc , fireball
  set %value %value + ( %number1 / 3 )
  return

  sub lower
  if %lootlower = #false
    return
  if lower , #spc , attack notin #property 3
    set %number1 0
  else
    gosub property a b lower , #spc , attack
  set %value %value + ( %number1 / 4 )
  if lower , #spc , defense notin #property 3
    set %number1 0
  else
    gosub property a b lower , #spc , defense
  set %value %value + ( %number1 / 4 )
  return

  sub luck
  if %lootluck = #false
    return
  if luck in #property 3
    gosub property a b luck
  event SysMessage Luck Rating: %number1
  if %number1 > 40
    set %value %value + ( %number1 / 5 )
  return

  sub bestWeapon
  if %lootbest = #false
    return
  if use , #spc , best , #spc , weapon in #property
    set %value %value + 2
  return

  sub chanceIncrease
  if %lootchance = #false
    return
  if hit , #spc , chance notin #property 3
    set %number1 0
  else
    gosub property a b hit , #spc , chance
  set %value %value + ( %number1 / 2 )
  if defense , #spc , chance notin #property 3
    set %number1 0
  else
    gosub property a b defense , #spc , chance
  set %value %value + ( %number1 / 2 )
  return


  sub speedIncrease
  if %lootspeed = #false
    return
  if swing , #spc , speed , #spc , increase notin #property 4
    set %number1 0
  else
    gosub property a b swing , #spc , speed , #spc , increase
  set %value %value + ( %number1 / 3 )
  return

  sub channeling
  if %lootsc = #false
    return
  if Channeling in #property 
    set %value %value + 2
  return

  sub leech
  if %lootleech = #false
    return
  if mana , #spc , leech notin #property 2
    set %number1 0
  else
    gosub property a b mana , #spc , leech
  set %value %value + ( %number1 / 3 )
  if stamina , #spc , leech notin #property 2
    set %number1 0
  else
    gosub property a b stamina , #spc , leech
  set %value %value + ( %number1 / 3 )
  if life , #spc , leech notin #property 2
    set %number1 0
  else
    gosub property a b life , #spc , leech
  set %value %value + ( %number1 / 3 )
  return

  sub damageIncrease
  if %lootleech = #false
    return
  if damage , #spc , increase notin #property 3
    set %number1 0
  else
    gosub property a b damage , #spc , increase
  set %value %value + ( %number1 / 4 ) + 1
  return

  sub resist
  if %lootresist = #false
    return
  gosub fire
  gosub cold
  gosub poison
  gosub energy
  gosub physical
  if %resist > 30
    set %value %value + ( ( %resist / 10 ) * 2 )
  return

  sub physical
  if physical , #spc , res notin #property 
    return
  gosub property a number physical , #spc , res
  set %resist %resist + %number1 
  return 

  sub energy
  if energy , #spc , res notin #property 
    return
  gosub property a number energy , #spc , res
  set %resist %resist + %number1 
  return 

  sub poison
  if poison , #spc , res notin #property 
    return
  gosub property a number poison , #spc , res
  set %resist %resist + %number1 
  return 

  sub fire
  if fire , #spc , res notin #property 
    return
  gosub property a number fire , #spc , res
  set %resist %resist + %number1 
  return 

  sub cold
  if cold , #spc , res notin #property 
    return
  gosub property a number cold , #spc , res
  set %resist %resist + %number1 
  return 

  sub property 
  Event SysMessage Return Init: %return
  str pos #property %3
  str del #property 1 #strres 
  set %return #strres 
  Event SysMessage Return 2nd: %return
  Event SysMessage Perc 3: %3
  str pos %return $ 
  if #strres > 1 
  {
    str del %return #strres 900 
    set %return #strres 
    str len %return 
    set %strlen #strres 
  }
  set %number1 1 
  str del %number1 1 1 
  set %number1 #strres 
  set %number2 1 
  str del %number2 1 1 
  set %number2 #strres 
  set %numb 1 
  for %i 1 %strlen 
  { 
    str mid %return %i 1 
    if ! ( #strres < 1 || #strres > 0 ) 3 
    {
      if %number1 > 0 2 
      {
        set %numb 2 
        goto skip 
      }
      if ( #strres < 1 || #strres > 0 ) 
      {
        set %number . %numb %number . %numb , #strres 
      }
    }
  }
  skip: 
  return