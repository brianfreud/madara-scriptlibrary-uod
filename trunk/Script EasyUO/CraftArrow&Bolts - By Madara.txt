;==================================================
; Name: Craft Arrow&Bolts 1.0
; Author: N/A - By Madara
; Version: 1.0.2
; Shard FS: UODreams
; Client Tested With: 7.0.15 - 7.0.21 - 7.0.22
; EUO version tested with: 1.5 v.236
; Last Revision: 20/04/2013
;==================================================
; ISTRUZIONI:
; 1- Andate alla banca, aprite la bankbox e
;    posizionatela dove preferite.
; 2- Board, Shaft e Feathers devono stare in banca,
;    i Fletching Tool nella borsa.
; 3- Lo script può usare anche tinker per creare
;    nuovi tool, quindi tenete almeno 1 TinkerTool
;    nella borsa e Iron nella banca.
;==================================================
set %tinker #true ; Crafta fletching tool se finiti
set %craft bolt ; Scrivi cosa vuoi craftare: arrow - bolt
set %shaftamount 1500 ; Quante di frecce da fare a botta
set %boards 350 ; Quantità max di board che puoi portare
set %lag 10 ; Valore di attesa tra un' azione e l' altra,
; se hai lag alta aumenta, piu è alto il valore e
; più lo script sarà lento.
;==================================================
set %tool UFG ; fletchingtool
set %shaft SLK
set %wood TLK
set %feather VLK
set %bolt LNK
set %arrow RWF
set %iron ENK
set %tinkertool KTL
;==================================================
InitEvents
set #lpc 10
if %craft = arrow
 set %make makearrows
else
 set %make makebolts
msg bank $
wait 1s
set %bankid #CONTID
set %featheramount %shaftamount
;======= MAIN ========
start:
 gosub reagentsfrombank
 gosub %make
 gosub boltstobank
goto start
;======= MAIN ========
sub reagentsfrombank
_loopresource:
gosub resourcetobank
gosub checktools
Finditem %shaft C_ , %bankid
if #findstack <= %shaftamount
{
 gosub makeshafts
}
Finditem %shaft C_ , %bankid
if #findstack >= %shaftamount
{
 Exevent Drag #findid %shaftamount
 wait %lag
 Exevent Dropc #backpackid
 wait %lag
}
else
 goto _loopresource
Finditem %feather C_ , %bankid
if #findstack < 1
{
 display ok Non hai abbastanza piume!
 halt
}
if #findstack >= %featheramount
{
 Exevent Drag #findid %featheramount
 wait %lag
 Exevent Dropc #backpackid
 wait %lag
}
else
 goto _loopresource
return

sub makeshafts
gosub checktools
Finditem %shaft C_ , %bankid
if #findstack <= %shaftamount
{
 Finditem %wood C_ , %bankid
 if #findstack < %boards
 {
  display ok Non hai abbastanza legna!
  halt
 }
 Exevent Drag #findid %boards
 wait %lag
 Exevent Dropc #backpackid
 wait %lag
 Finditem %tool C_ , #backpackid
 set #lobjectid #findid
 set #ltargetkind 1
 while #contname <> generic_gump
  event macro 17
 wait %lag
 set %x ( #contposx + 29 )
 set %y ( #contposy + 90 )
 click %x %y
 wait %lag
 set %x ( #contposx + 232 )
 set %y ( #contposy + 89 )
 click %x %y
 while #contname <> generic_gump
  gosub checktools
 ;event macro 31
 click %x %y r
 wait %lag
 gosub shaftstobank
}
return

sub notools
_loopcraft:
Finditem %tool C_ , #backpackid
if #findcnt > 0
 return
Finditem %iron C_ , %bankid
if #findstack < 20
{
 display ok Non hai abbastanza Iron!
 halt
}
Exevent Drag #findid 20
wait %lag
Exevent Dropc #backpackid
wait %lag
Finditem %tinkertool C_ , #backpackid
if #findcnt < 2
{
 if #findcnt < 1
 {
  display ok Serve almeno un Tinker Tool nella tua borsa!
  halt
 }
 set #lobjectid #findid
 set #ltargetkind 1
 while #contname <> generic_gump
  event macro 17
 wait %lag
 set %x ( #contposx + 26 )
 set %y ( #contposy + 110 )
 click %x %y
 wait %lag
 set %x ( #contposx + 233 )
 set %y ( #contposy + 131 )
 click %x %y
 while #contname <> generic_gump
  gosub checktools
 click %x %y r
 Finditem %tinkertool C_ , #backpackid
 if #findcnt < 2
  goto _loopcraft
}
while #contname <> generic_gump
  event macro 17
wait %lag
set %x ( #contposx + 26 )
set %y ( #contposy + 110 )
click %x %y
wait %lag
set %x ( #contposx + 382 )
set %y ( #contposy + 272 )
click %x %y
wait %lag
set %x ( #contposx + 382 )
set %y ( #contposy + 272 )
click %x %y
wait %lag
set %x ( #contposx + 233 )
set %y ( #contposy + 69 )
click %x %y
while #contname <> generic_gump
  gosub checktools
;event macro 31
click %x %y r
Finditem %iron C_ , #backpackid
Exevent Drag #findid #findstack
wait %lag
Exevent Dropc %bankid
wait %lag
return
 
sub checktools
Finditem %tool C_ , #backpackid
if #findcnt < 1 && %tinker = #true
{
 gosub notools
}
if #findcnt < 1 && %tinker = #false
{
 display ok Serve almeno un Tinker Tool nella tua borsa!
 halt
}
return

sub shaftstobank
gosub checktools
Finditem %shaft C_ , #backpackid
Exevent Drag #findid #findstack
wait %lag
Exevent Dropc %bankid
wait %lag
return
 
sub makebolts
gosub checktools
Finditem %tool C_ , #backpackid
 set #lobjectid #findid
 set #ltargetkind 1
 while #contname <> generic_gump
  event macro 17
 wait %lag
 set %x ( #contposx + 26 )
 set %y ( #contposy + 111 )
 click %x %y
 wait %lag
 set %x ( #contposx + 233 )
 set %y ( #contposy + 90 )
 click %x %y
 while #contname <> generic_gump
  gosub checktools
 click %x %y r
return

sub makearrows
gosub checktools
Finditem %tool C_ , #backpackid
 set #lobjectid #findid
 set #ltargetkind 1
 while #contname <> generic_gump
  event macro 17
 wait %lag
 set %x ( #contposx + 28 )
 set %y ( #contposy + 111 )
 click %x %y
 wait %lag
 set %x ( #contposx + 233 )
 set %y ( #contposy + 70 )
 click %x %y
 while #contname <> generic_gump
  gosub checktools
 click %x %y r
return

sub boltstobank
Finditem %bolt C_ , #backpackid
Exevent Drag #findid #findstack
wait %lag
Exevent Dropc %bankid
wait %lag
return

sub resourcetobank
Finditem %bolt C_ , #backpackid
if #findcnt > 0
{
 Exevent Drag #findid #findstack
 wait %lag
 Exevent Dropc %bankid
 wait %lag
}
Finditem %shaft C_ , #backpackid
if #findcnt > 0
{
 Exevent Drag #findid #findstack
 wait %lag
 Exevent Dropc %bankid
 wait %lag
}
Finditem %wood C_ , #backpackid
if #findcnt > 0
{
 Exevent Drag #findid #findstack
 wait %lag
 Exevent Dropc %bankid
 wait %lag
}
Finditem %feather C_ , #backpackid
if #findcnt > 0
{
 Exevent Drag #findid #findstack
 wait %lag
 Exevent Dropc %bankid
 wait %lag
}
Finditem %arrow C_ , #backpackid
if #findcnt > 0
{
 Exevent Drag #findid #findstack
 wait %lag
 Exevent Dropc %bankid
 wait %lag
}
Finditem %iron C_ , #backpackid
if #findcnt > 0
{
 Exevent Drag #findid #findstack
 wait %lag
 Exevent Dropc %bankid
 wait %lag
}
return

; end
halt
