set %CurseWeaponShow #SCNT
set %CurseWeapon #SCNT2
set %Honor #SCNT2
set %HonorActive #false
set %HonorShow #SCNT
set %JournalIndex #Jindex

KeyLooP:
onhotkey 1
         gosub CurseWeapon
gosub JournalReader
gosub ShowMessaggi
goto KeyLooP

sub ShowMessaggi
if %CurseWeapon >= #SCNT2 &&  %CurseWeapon - #SCNT2 < 50
{
 if %CurseWeaponShow <> #SCNT
 {
     set %timeout  ( %CurseWeapon - #SCNT2 ) / 10
     event ExMsg #charID 3 138 Curse , #spc , %timeout
     set %CurseWeaponShow #SCNT
 }
}
if ( %HonorActive = #false && %Honor >= #SCNT2  ) || %HonorActive = #true
{
 if %HonorShow < #SCNT
 {
     if %HonorActive = #true
        {
          set %timeout  ( #SCNT2 - %Honor ) / 10
          event ExMsg #charID 3 75 Honor , #spc , %timeout
          set %HonorShow #SCNT
          }
     else
         {
          set %timeout  ( %Honor - #SCNT2 ) / 10
          event ExMsg #charID 3 1 Honor , #spc , %timeout
          set %HonorShow #SCNT + 10
          }
 }
}
return

sub JournalReader
for %i %JournalIndex #jindex
     {
     scanjournal %i
     if You_embrace_your_honor in #journal
        {
         set %Honor #SCNT2
         set %HonorActive #true
        }
     if You_no_longer_embrace_your_honor in #journal
        {
         set %Honor #SCNT2 + 3000
         set %HonorActive #false
        }
     }
set %JournalIndex %i - 1
return

sub CurseWeapon
event macro  15 104 ;Cast Spell [N] Curse Weapon
chooseskill spir r
set %CurseWeapon #skill * 10 / 34 + 10
set %CurseWeapon #SCNT2 + %CurseWeapon
return  