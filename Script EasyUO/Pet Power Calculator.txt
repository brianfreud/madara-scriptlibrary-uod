;==================================================
; Name: Pet Power Calculator 4.4
; Author: Cerveza
; Revision: 4.0~4.4 By Madara & Larhalt de Shack
; Shard FS: UODreams
; Client Tested With: 7.0.15 - 7.0.21 - 7.0.22
; EUO version tested with: 1.5 v.236
; Public Release: 13/03/2013
; Last Revision: 14/05/2014
; Credits: Kal In Ex
;==================================================
; COSA FA LO SCRIPT?
; - Calcola le statistiche, le resistenze e gli hp
;   del Pet selezionato, riportando il tutto su una
;   scala da 1 a 5(Stelle).
; - E' possibile mettere a confronto due Pet mettendo
;   la spunta su "Compare".
; - E' possibile sapere da subito quante Stelle
;   avrà il vostro Pet con le Stat al massimo,
;   basta mettere la spunta su "Stat Max".
;==================================================
set %ver 4.4 ; Script Version
set %lag_page 1 ; Lag_Page:  1 ~ 10
set #lpc 1000
;==================================================
set %Bake_Kitsune EH
set %Cu_Sidhe FN
set %Fire_Steed YJ
set %GDragon DF_CD
set %Hiryu HH
set %Nightmare EC_UJ_TJ
set %Reptalon GN
set %Rune_Beetle CH
set %White_Wyrm OJ_TE
;==================================================
set %kal_gumpX 10
set %kal_gumpY 10
;==================================================
set %heal_poison Poisoning
;==================================================
set #MENUBUTTON N/A
set %currentpettype 0
set %total 0.0
set %export #false
set %menu1 #true
set %menu2 #false
set %Compare #false
set %Return #false
set %SMax1 #false
set %SMax2 #false
set %UODreams #false
if #shard = UODreams
{
 display yesno Shard Detected: #shard $
              +Do you want to use #shard List Stat?
 if #dispres = #true
    set %UODreams #true
}
menu clear
gosub showEUOMenu1
menu Show
menu HideEUO
;********** Main Loop **********
SUO:
event sysmessage Script: ready to start.
SUO2:
onhotkey space shift
 goto key_start
set %tame #false
menu get Compare
set %Compare #menures
if %Compare = #true
{
 menu delete Next
 menu delete Export
 menu delete Open
 menu Font Size 16
 menu Font Style
 menu Font Color Navy
 menu Font BGColor Yellow
 menu Font Name MS Sans Serif
 menu Button Next 5 7 176 60 Target 1° Pet
}
if #MENUBUTTON = NEXT
{
 key_start:
 menu get SMax1
 set %SMax1 #menures
 ;menu get SMax2
 ;set %SMax2 #menures
 set %menu1 #true
 set %menu2 #false
 gosub lore
 gosub ocr
 gosub calculations
 gosub star
 gosub score
 set %export #true
 menu delete SMax1
 gosub clean
 set %txt PetPower_Export_ , %name , .txt
 set #MENUBUTTON N/A
}
if #MENUBUTTON = NEXT_2
{
 menu get SMax2
 set %SMax2 #menures
 set %menu1 #false
 set %menu2 #true
 gosub lore
 gosub ocr
 gosub calculations
 gosub star
 gosub score
 set %export #true
 menu delete SMax2
 gosub clean
 menu set EUOLabel333 %name
 set %txt PetPower_Export_ , %name , .txt
 set #MENUBUTTON N/A
}
if #MENUBUTTON = CLOSED
 halt
if #MENUBUTTON = EXPORT && %export = #true
{
 menu set Export Wait...
 gosub export
 menu set Export Export
 set #MENUBUTTON N/A
}
if #MENUBUTTON = OPEN
{
 execute %txt
 set #menubutton N/A
}
if %Compare = #true && %menu1 = #true && %menu2 = #false
{
  set %menu2 #true
  menu delete Compare
  gosub clean_all
  gosub showEUOMenu1
}
;if %Compare = #true && %menu1 = #false && %menu2 = #true
;{
; set %menu2 #false
; gosub clean_all
; gosub showEUOMenu1
;}
while #CharGhost = YES
  wait 0
Goto SUO2
;********** Subs **********
sub lore
  loop_lore:
  event macro 13 2
  target 2s
  while #targcurs = 1
    wait 0
  set %Pet #ltargetid
  set %gump_time_loop ( #scnt + 3 )
  event sysmessage Script: waiting animal lore gump...
  while #contsize <> 400_381
  {
   if #scnt >= %gump_time_loop
   {
    set #menubutton N/A
    goto suo
   }
  }
  ;set #contposx %kal_gumpX
  ;set #contposy %kal_gumpY
  set %kal_gumpX #contposx
  set %kal_gumpY #contposy
  finditem #ltargetid *
  gosub pet_type_info
  if %currentpettype = 2
    set %heal_poison Healing
  else
    set %heal_poison Poisoning
return


sub ocr
  ; ********** Stats **********
  ; PAUSE
  
  return_kalocr_stat:
  set !pix_to_save_X ( #contposx + 173 )
  set !pix_to_save_Y ( #contposy + 155 )
  savepix !pix_to_save_X !pix_to_save_Y 100
  if #pixcol <> 4337920
  {
     gosub OffsetClick 347 366 f
     wait %lag_page
     goto return_kalocr_stat
  }
  gosub kalocr.txt getLoreInfo 1 value %kal_gumpX %kal_gumpY
  set %LoreNum !lore_value
  str pos %LoreNum /
  set #strres #strres - 1
  str right %LoreNum #strres
  set %LoreNum #strres
  set %sel_stat_hitpoints %LoreNum
  gosub kalocr.txt getLoreInfo 4 value %kal_gumpX %kal_gumpY
  set %sel_stat_strength !lore_value
  gosub kalocr.txt getLoreInfo 5 value %kal_gumpX %kal_gumpY
  set %sel_stat_dexterity !lore_value
  gosub kalocr.txt getLoreInfo 6 value %kal_gumpX %kal_gumpY
  set %sel_stat_intelligence !lore_value
  
  ; ********** Resists **********
  
  return_kalocr_resist:
  set !pix_to_save_X ( #contposx + 167 )
  set !pix_to_save_Y ( #contposy + 155 )
  savepix !pix_to_save_X !pix_to_save_Y 100
  if #pixcol <> 4337920
  {
     gosub OffsetClick 347 366 f
     wait %lag_page
     goto return_kalocr_resist
  }
  gosub kalocr.txt getLoreInfo 1 value %kal_gumpX %kal_gumpY
  set %lorenum !lore_value
  str Len %lorenum
  set %digits #strRes
  set %digits %digits - 1
  str Left %lorenum %digits
  set %sel_resist_physical #strRes
  gosub kalocr.txt getLoreInfo 2 value %kal_gumpX %kal_gumpY
  set %lorenum !lore_value
  str Len %lorenum
  set %digits #strRes
  set %digits %digits - 1
  str Left %lorenum %digits
  set %sel_resist_fire #strRes
  gosub kalocr.txt getLoreInfo 3 value %kal_gumpX %kal_gumpY
  set %lorenum !lore_value
  str Len %lorenum
  set %digits #strRes
  set %digits %digits - 1
  str Left %lorenum %digits
  set %sel_resist_cold #strRes
  gosub kalocr.txt getLoreInfo 4 value %kal_gumpX %kal_gumpY
  set %lorenum !lore_value
  str Len %lorenum
  set %digits #strRes
  set %digits %digits - 1
  str Left %lorenum %digits
  set %sel_resist_poison #strRes
  gosub kalocr.txt getLoreInfo 5 value %kal_gumpX %kal_gumpY
  set %lorenum !lore_value
  str Len %lorenum
  set %digits #strRes
  set %digits %digits - 1
  str Left %lorenum %digits
  set %sel_resist_energy #strRes
  
  ; ********** Skills **********
  
  return_kalocr_skill:
  set !pix_to_save_X ( #contposx + 171 )
  set !pix_to_save_Y ( #contposy + 155 )
  savepix !pix_to_save_X !pix_to_save_Y 100
  if #pixcol <> 4337920
  {
     gosub OffsetClick 347 366 f
     wait %lag_page
     goto return_kalocr_skill
  }
  gosub kalocr.txt getLoreInfo 1 value %kal_gumpX %kal_gumpY
  set %lorenum !lore_value
  str Len %lorenum
  set %digits #strRes
  set %digits %digits - 1
  str Left %lorenum %digits
  set %sel_skill_wrestling #strRes
  
  gosub kalocr.txt getLoreInfo 1 value %kal_gumpX %kal_gumpY
  set %sel_skill_wrestling !lore_value
  gosub kalocr.txt getLoreInfo 2 value %kal_gumpX %kal_gumpY
  set %sel_skill_tactics !lore_value
  gosub kalocr.txt getLoreInfo 3 value %kal_gumpX %kal_gumpY
  set %sel_skill_resistance !lore_value
  gosub kalocr.txt getLoreInfo 4 value %kal_gumpX %kal_gumpY
  set %sel_skill_anatomy !lore_value
  gosub kalocr.txt getLoreInfo 5 value %kal_gumpX %kal_gumpY
  set %sel_skill_poisoning !lore_value
  gosub kalocr.txt getLoreInfo 7 value %kal_gumpX %kal_gumpY
  set %sel_skill_magery !lore_value
  gosub kalocr.txt getLoreInfo 8 value %kal_gumpX %kal_gumpY
  set %sel_skill_eval !lore_value
  gosub kalocr.txt getLoreInfo 9 value %kal_gumpX %kal_gumpY
  set %sel_skill_meditation !lore_value
return

sub calculations

  ;=========================== pet sel
  if %tame = #false
  {
   set %dex ( %sel_stat_dexterity / 2 )
   if %SMax1 = #true && %dex <= 125 && %menu1 = #true || %SMax2 = #true && %dex <= 125 && %menu2 = #true
    set %dex 125
   set %str ( %sel_stat_strength / 2 )
   if %SMax1 = #true && %str <= 125 && %menu1 = #true || %SMax2 = #true && %str <= 125 && %menu2 = #true
    set %str 125
   set %int ( %sel_stat_intelligence / 2 )
   if %SMax1 = #true && %int <= 125 && %menu1 = #true || %SMax2 = #true && %int <= 125 && %menu2 = #true
    set %int 125
   set %hitp ( %sel_stat_hitpoints / 2 )

   gosub add %str %dex
   set %stat1 #result
   gosub add %stat1 %int
   set %stat2 #result
   gosub multiply %stat2 0.10
   set %stat10 #result

   gosub multiply %hitp 0.25
   set %hp25 #result
  }
  if %tame = #true
  {
   if %SMax1 = #true && %sel_stat_dexterity <= 125 && %menu1 = #true || %SMax2 = #true && %sel_stat_dexterity <= 125 && %menu2 = #true
    set %sel_stat_dexterity 125
   if %SMax1 = #true && %sel_stat_strength <= 125 && %menu1 = #true || %SMax2 = #true && %sel_stat_strength <= 125 && %menu2 = #true
    set %sel_stat_strength 125
   if %SMax1 = #true && %sel_stat_intelligence <= 125 && %menu1 = #true || %SMax2 = #true && %sel_stat_intelligence <= 125 && %menu2 = #true
    set %sel_stat_intelligence 125
   gosub add %sel_stat_strength %sel_stat_dexterity
   set %stat1 #result
   gosub add %stat1 %sel_stat_intelligence
   set %stat2 #result
   gosub multiply %stat2 0.10
   set %stat10 #result

   gosub multiply %sel_stat_hitpoints 0.25
   set %hp25 #result
  }
  gosub add %sel_resist_physical %sel_resist_fire
  set %res1 #result
  gosub add %res1 %sel_resist_cold
  set %res2 #result
  gosub add %res2 %sel_resist_poison
  set %res3 #result
  gosub add %res3 %sel_resist_energy
  set %res4 #result
  gosub multiply %res4 0.65
  set %res65 #result

  gosub add %stat10 %hp25
  set %tot1 #result
  gosub add %tot1 %res65
  set %sel_tot #result
  
  ;display ok %sel_tot
  ;halt
  
  ;=========================== pet max
  if %tame = #false
  {
   set %dex ( %max_stat_dexterity / 2 )
   if %dex <= 125
    set %dex 125
   set %str ( %max_stat_strength / 2 )
   if %str <= 125
    set %str 125
   set %int ( %max_stat_intelligence / 2 )
   if %int <= 125
    set %int 125
   set %hitp ( %max_stat_hitpoints / 2 )

   gosub add %str %dex
   set %stat1 #result
   gosub add %stat1 %int
   set %stat2 #result
   gosub multiply %stat2 0.10
   set %max_stat10 #result

   gosub multiply %hitp 0.25
   set %max_hp25 #result
  }
  if %tame = #true
  {
   if %max_stat_dexterity <= 125
    set %max_stat_dexterity 125
   if %max_stat_strength <= 125
    set %max_stat_strength 125
   if %max_stat_intelligence <= 125
    set %max_stat_intelligence 125
   gosub add %max_stat_strength %max_stat_dexterity
   set %stat1 #result
   gosub add %stat1 %max_stat_intelligence
   set %stat2 #result
   gosub multiply %stat2 0.10
   set %max_stat10 #result

   gosub multiply %max_stat_hitpoints 0.25
   set %max_hp25 #result
  }
  gosub add %max_resist_physical %max_resist_fire
  set %res1 #result
  gosub add %res1 %max_resist_cold
  set %res2 #result
  gosub add %res2 %max_resist_poison
  set %res3 #result
  gosub add %res3 %max_resist_energy
  set %res4 #result
  gosub multiply %res4 0.65
  set %max_res65 #result

  gosub add %max_stat10 %max_hp25
  set %tot1 #result
  gosub add %tot1 %max_res65
  set %max_tot #result
  
  ;display ok %max_tot
  ;halt
  
  ;=========================== pet min
  if %tame = #false
  {
   set %dex ( %min_stat_dexterity / 2 )
   set %str ( %min_stat_strength / 2 )
   set %int ( %min_stat_intelligence / 2 )
   set %hitp ( %min_stat_hitpoints / 2 )

   gosub add %str %dex
   set %stat1 #result
   gosub add %stat1 %int
   set %stat2 #result
   gosub multiply %stat2 0.10
   set %min_stat10 #result

   gosub multiply %hitp 0.25
   set %min_hp25 #result
  }
  if %tame = #true
  {
   gosub add %min_stat_strength %min_stat_dexterity
   set %stat1 #result
   gosub add %stat1 %min_stat_intelligence
   set %stat2 #result
   gosub multiply %stat2 0.10
   set %min_stat10 #result

   gosub multiply %min_stat_hitpoints 0.25
   set %min_hp25 #result
  }
  gosub add %min_resist_physical %min_resist_fire
  set %res1 #result
  gosub add %res1 %min_resist_cold
  set %res2 #result
  gosub add %res2 %min_resist_poison
  set %res3 #result
  gosub add %res3 %min_resist_energy
  set %res4 #result
  gosub multiply %res4 0.65
  set %min_res65 #result

  gosub add %min_stat10 %min_hp25
  set %tot1 #result
  gosub add %tot1 %min_res65
  set %min_tot #result
  
  ;display ok %min_tot
  ;halt
  
  ;=========================== power calc
  gosub subtract %sel_tot %min_tot
  set %form1 #result
  gosub subtract %max_tot %min_tot
  set %form2 #result
  gosub divide %form1 %form2 10
  set %form3 #result
  gosub multiply %form3 5
  set %total #result
  str left %total 3
  set %total #strres
  
  ;display ok %total
  ;halt
  
return

sub star
 str left %total 1
 if #strres >= 1
  set %stars *
 if #strres >= 2
  set %stars * , #spc , *
 if #strres >= 3
  set %stars * , #spc , * , #spc , *
 if #strres >= 4
  set %stars * , #spc , * , #spc , * , #spc , *
 if #strres >= 5
  set %stars * , #spc , * , #spc , * , #spc , * , #spc , *
return

sub clean
  gosub showEUOMenu1
  wait 5
  set #MENUBUTTON N/A
  gosub OffsetClick 347 366 r
return
;--------- EasyUO Menu Designer Code Begin ---------
sub showEUOMenu1
 if %menu2 = #false
 {
  if %Compare = #false
  {
   menu Clear
   menu Window Title Pet Power Calculator %ver
   menu Window Size 378 356
  }
  menu Window Color Black
  menu Font Transparent #true
  menu Font Align Right
  menu Shape EUOShape3 188 88 189 221 3 7 1 Black 4 Black
  menu Shape EUOShape2 0 208 189 145 3 7 1 Black 7 Black
  menu Shape EUOShape1 0 88 189 121 3 7 1 Black 7 Black
  menu Font Name MS Sans Serif
  menu Font Size 18
  menu Font Style
  menu Font Color WindowText
  menu Font Transparent #false
  menu Font Align Center
  menu Font BGColor Black
  menu Font Size 8
  menu Font Color Lime
  menu Font Align Left
  menu Text EUOLabel2 5 112 Hit Points
  menu Text EUOLabel4 5 137 Strength
  menu Text EUOLabel6 5 187 Intelligence
  menu Text EUOLabel10 5 232 Physical
  menu Text EUOLabel12 5 257 Fire
  menu Text EUOLabel13 5 282 Cold
  menu Text EUOLabel14 5 307 Poison
  menu Text EUOLabel18 5 332 Energy
  menu Text EUOLabel19 195 112 Wrestling
  menu Text EUOLabel21 195 137 Tactics
  menu Text EUOLabel31 195 162 Ress Spell
  menu Text EUOLabel23 195 187 Anatomy
  menu Text EUOLabel27 195 212 %heal_poison
  menu Text EUOLabel28 195 237 Magery
  menu Text EUOLabel29 195 262 Eval Int
  menu Text EUOLabel30 195 287 Meditation
  menu Text EUOLabel5 5 162 Dexterity
  menu Font Color Yellow
  menu Text EUOLabel7 112 92 Pet
  menu Text EUOLabel8 69 92 Min
  menu Text EUOLabel3 153 92 Max
  menu Text EUOLabel11 153 212 Max
  menu Text EUOLabel20 344 92 Max
  menu Text EUOLabel15 112 212 Pet
  menu Text EUOLabel16 69 212  Min
  menu Text EUOLabel24 303 92 Pet
  menu Text EUOLabel25 260 92 Min
  menu Font Style b
  menu Text EUOLabel9 5 92 Stats
  menu Text EUOLabel17 5 212 Resists
  menu Text EUOLabel26 195 92 Skills
  menu Font Color Silver
  menu Font Size 27
  menu Font Style b
  menu Font Name MS Sans Serif
  menu Text EUOLabel335 223 15 * , #spc , * , #spc , * , #spc , * , #spc , *
  if %stars <> N/A
  {
   menu Font Color Yellow
   menu Font Size 27
   menu Font Style b
   menu Text EUOLabel335 223 15 %stars
  }
  menu Font Size 24
  menu Font Color Red
  menu Text EUOLabel22 260 50 %total
  menu Font Color Yellow
  menu Font Size 8
  menu Text EUOLabel385 196 313 Revision %ver By
  menu Text EUOLabel334 196 333 Madara and Larhalt de Shack
  menu Text EUOLabel33 237 5 Pet Power Stars
  menu Font Color Yellow
  menu Font BGColor Black
  menu Font Size 9
  menu Font Style b
  if %Compare = #false
   menu Check Compare 94 75 90 10 %Compare Compare?
  menu Check SMax1 5 75 90 10 %SMax1 Max Stat?
  menu Font Style
  menu Font Color Black
  menu Font BGColor Silver
  menu Edit EUOEdit1 146 107 34 %max_stat_hitpoints
  menu Edit EUOEdit2 146 132 34 %max_stat_strength
  menu Edit EUOEdit3 146 157 34 %max_stat_dexterity
  menu Edit EUOEdit4 146 182 34 %max_stat_intelligence
  menu Font BGColor Silver
  menu Edit EUOEdit13 146 227 34 %max_resist_physical
  menu Edit EUOEdit14 146 252 34 %max_resist_fire
  menu Edit EUOEdit15 146 277 34 %max_resist_cold
  menu Edit EUOEdit16 146 302 34 %max_resist_poison
  menu Edit EUOEdit25 146 327 34 %max_resist_energy
  menu Font BGColor Silver
  menu Edit EUOEdit28 337 107 34 %max_skill_wrestling
  menu Edit EUOEdit29 337 132 34 %max_skill_tactics
  menu Edit EUOEdit30 337 157 34 %max_skill_resistance
  menu Edit EUOEdit31 337 182 34 %max_skill_anatomy
  menu Edit EUOEdit40 337 207 34 %max_skill_poisoning
  menu Edit EUOEdit43 337 232 34 %max_skill_magery
  menu Edit EUOEdit44 337 257 34 %max_skill_eval
  menu Edit EUOEdit49 337 282 34 %max_skill_meditation
  menu Edit EUOEdit36 255 107 34 %min_skill_wrestling
  menu Edit EUOEdit37 255 132 34 %min_skill_tactics
  menu Edit EUOEdit38 255 157 34 %min_skill_resistance
  menu Edit EUOEdit39 255 182 34 %min_skill_anatomy
  menu Edit EUOEdit42 255 207 34 %min_skill_poisoning
  menu Edit EUOEdit47 255 232 34 %min_skill_magery
  menu Edit EUOEdit48 255 257 34 %min_skill_eval
  menu Edit EUOEdit51 255 282 34 %min_skill_meditation
  menu Font Color WindowText
  menu Font BGColor yellow
  menu Edit EUOEdit5 105 107 34 %sel_stat_hitpoints
  menu Edit EUOEdit6 105 132 34 %sel_stat_strength
  menu Edit EUOEdit7 105 157 34 %sel_stat_dexterity
  menu Edit EUOEdit8 105 182 34 %sel_stat_intelligence
  menu Edit EUOEdit17 105 227 34 %sel_resist_physical
  menu Edit EUOEdit18 105 252 34 %sel_resist_fire
  menu Edit EUOEdit19 105 277 34 %sel_resist_cold
  menu Edit EUOEdit20 105 302 34 %sel_resist_poison
  menu Edit EUOEdit32 296 107 34 %sel_skill_wrestling
  menu Edit EUOEdit33 296 132 34 %sel_skill_tactics
  menu Edit EUOEdit34 296 157 34 %sel_skill_resistance
  menu Edit EUOEdit35 296 182 34 %sel_skill_anatomy
  menu Edit EUOEdit41 296 207 34 %sel_skill_poisoning
  menu Edit EUOEdit45 296 232 34 %sel_skill_magery
  menu Edit EUOEdit50 296 282 34 %sel_skill_meditation
  menu Edit EUOEdit46 296 257 34 %sel_skill_eval
  menu Edit EUOEdit26 105 327 34 %sel_resist_energy
  menu Font BGColor Silver
  menu Font Size 9
  menu Edit EUOEdit9 64 107 34  %min_stat_hitpoints
  menu Edit EUOEdit10 64 132 34 %min_stat_strength
  menu Edit EUOEdit11 64 157 34 %min_stat_dexterity
  menu Edit EUOEdit12 64 182 34 %min_stat_intelligence
  menu Edit EUOEdit21 64 227 34 %min_resist_physical
  menu Edit EUOEdit22 64 252 34 %min_resist_fire
  menu Edit EUOEdit23 64 277 34 %min_resist_cold
  menu Edit EUOEdit24 64 302 34 %min_resist_poison
  menu Edit EUOEdit27 64 327 34 %min_resist_energy
  menu Font Size 16
  menu Font Color Navy
  menu Font BGColor Yellow
  if %Compare = #false
  {
   menu Button Next 5 7 176 30 Target Pet
   menu Button Export 5 40 86 30 Export
   menu Button Open 94 40 86 30 Open
  }
 }
 if %menu2 = #true
 {
  menu Window Color Black
  menu Window Size 756 356
  menu Font Name MS Sans Serif
  menu Font Size 18
  menu Font Style
  menu Font Color WindowText
  menu Font Transparent #false
  menu Font Align Center
  menu Font BGColor Black
  menu Font Size 8
  menu Font Color Lime
  menu Font Align Left
  menu Text EUOLabel2 382 112 Hit Points
  menu Text EUOLabel4 382 137 Strength
  menu Text EUOLabel6 382 187 Intelligence
  menu Text EUOLabel10 382 232 Physical
  menu Text EUOLabel12 382 257 Fire
  menu Text EUOLabel13 382 282 Cold
  menu Text EUOLabel14 382 307 Poison
  menu Text EUOLabel18 382 332 Energy
  menu Text EUOLabel19 573 112 Wrestling
  menu Text EUOLabel21 573 137 Tactics
  menu Text EUOLabel31 573 162 Ress Spell
  menu Text EUOLabel23 573 187 Anatomy
  menu Text EUOLabel27 573 212 %heal_poison
  menu Text EUOLabel28 573 237 Magery
  menu Text EUOLabel29 573 262 Eval Int
  menu Text EUOLabel30 573 287 Meditation
  menu Text EUOLabel5 382 162 Dexterity
  menu Font Color Yellow
  menu Text EUOLabel7 490 92 Pet
  menu Text EUOLabel8 447 92 Min
  menu Text EUOLabel3 531 92 Max
  menu Text EUOLabel11 531 212 Max
  menu Text EUOLabel20 722 92 Max
  menu Text EUOLabel15 490 212 Pet
  menu Text EUOLabel16 447 212  Min
  menu Text EUOLabel24 681 92 Pet
  menu Text EUOLabel25 638 92 Min
  menu Font Style b
  menu Text EUOLabel9 382 92 Stats
  menu Text EUOLabel17 382 212 Resists
  menu Text EUOLabel26 573 92 Skills
  menu Font Color Silver
  menu Font Size 27
  menu Font Style b
  menu Text EUOLabel335 601 15 * , #spc , * , #spc , * , #spc , * , #spc , *
  if %stars <> N/A
  {
   menu Font Color Yellow
   menu Font Size 27
   menu Font Style b
   menu Text EUOLabel335 601 15 %stars
  }
  menu Font Size 24
  menu Font Color Red
  menu Text EUOLabel22 638 50 %total
  menu Font Color Yellow
  menu Font Size 8
  menu Check SMax2 383 75 90 10 %SMax2 Max Stat?
  menu Text EUOLabel33 615 5 Pet Power Stars
  ;menu Check Return 383 75 180 10 %Return Return to 1 Pet Calc?
  menu Font Size 12
  menu Font Style b
  if %name = N/A
   menu Text EUOLabel333 610 318 Compare Pet
  menu Font Size 8
  menu Font Style
  menu Font Color Black
  menu Font BGColor Silver
  menu Edit EUOEdit1 524 107 34 %max_stat_hitpoints
  menu Edit EUOEdit2 524 132 34 %max_stat_strength
  menu Edit EUOEdit3 524 157 34 %max_stat_dexterity
  menu Edit EUOEdit4 524 182 34 %max_stat_intelligence
  menu Font BGColor Silver
  menu Edit EUOEdit13 524 227 34 %max_resist_physical
  menu Edit EUOEdit14 524 252 34 %max_resist_fire
  menu Edit EUOEdit15 524 277 34 %max_resist_cold
  menu Edit EUOEdit16 524 302 34 %max_resist_poison
  menu Edit EUOEdit25 524 327 34 %max_resist_energy
  menu Font BGColor Silver
  menu Edit EUOEdit28 715 107 34 %max_skill_wrestling
  menu Edit EUOEdit29 715 132 34 %max_skill_tactics
  menu Edit EUOEdit30 715 157 34 %max_skill_resistance
  menu Edit EUOEdit31 715 182 34 %max_skill_anatomy
  menu Edit EUOEdit40 715 207 34 %max_skill_poisoning
  menu Edit EUOEdit43 715 232 34 %max_skill_magery
  menu Edit EUOEdit44 715 257 34 %max_skill_eval
  menu Edit EUOEdit49 715 282 34 %max_skill_meditation
  menu Edit EUOEdit36 633 107 34 %min_skill_wrestling
  menu Edit EUOEdit37 633 132 34 %min_skill_tactics
  menu Edit EUOEdit38 633 157 34 %min_skill_resistance
  menu Edit EUOEdit39 633 182 34 %min_skill_anatomy
  menu Edit EUOEdit42 633 207 34 %min_skill_poisoning
  menu Edit EUOEdit47 633 232 34 %min_skill_magery
  menu Edit EUOEdit48 633 257 34 %min_skill_eval
  menu Edit EUOEdit51 633 282 34 %min_skill_meditation
  menu Font Color WindowText
  menu Font BGColor yellow
  menu Edit EUOEdit5 483 107 34 %sel_stat_hitpoints
  menu Edit EUOEdit6 483 132 34 %sel_stat_strength
  menu Edit EUOEdit7 483 157 34 %sel_stat_dexterity
  menu Edit EUOEdit8 483 182 34 %sel_stat_intelligence
  menu Edit EUOEdit17 483 227 34 %sel_resist_physical
  menu Edit EUOEdit18 483 252 34 %sel_resist_fire
  menu Edit EUOEdit19 483 277 34 %sel_resist_cold
  menu Edit EUOEdit20 483 302 34 %sel_resist_poison
  menu Edit EUOEdit32 674 107 34 %sel_skill_wrestling
  menu Edit EUOEdit33 674 132 34 %sel_skill_tactics
  menu Edit EUOEdit34 674 157 34 %sel_skill_resistance
  menu Edit EUOEdit35 674 182 34 %sel_skill_anatomy
  menu Edit EUOEdit41 674 207 34 %sel_skill_poisoning
  menu Edit EUOEdit45 674 232 34 %sel_skill_magery
  menu Edit EUOEdit50 674 282 34 %sel_skill_meditation
  menu Edit EUOEdit46 674 257 34 %sel_skill_eval
  menu Edit EUOEdit26 483 327 34 %sel_resist_energy
  menu Font BGColor Silver
  menu Font Size 9
  menu Edit EUOEdit9 441 107 34  %min_stat_hitpoints
  menu Edit EUOEdit10 441 132 34 %min_stat_strength
  menu Edit EUOEdit11 441 157 34 %min_stat_dexterity
  menu Edit EUOEdit12 441 182 34 %min_stat_intelligence
  menu Edit EUOEdit21 441 227 34 %min_resist_physical
  menu Edit EUOEdit22 441 252 34 %min_resist_fire
  menu Edit EUOEdit23 441 277 34 %min_resist_cold
  menu Edit EUOEdit24 441 302 34 %min_resist_poison
  menu Edit EUOEdit27 441 327 34 %min_resist_energy
  menu Font Size 16
  menu Font Color Navy
  menu Font BGColor Yellow
  menu Button Next_2 383 7 176 60 Target 2° Pet
  }
return
;--------- EasyUO Menu Designer Code End ---------
sub pet_type_info
  finditem %Pet G_
  event property #findid
  if tame in #property || bonded in #property
   set %tame #true
  else
   set %tame #false
  if #findtype in %Cu_Sidhe
  {
    if %tame = #true
    {
     set %currentpettype 2
     set %name CuSidhe
     if %UODreams = #true
        set %max_stat_hitpoints 600
     else
        set %max_stat_hitpoints 638
     set %max_stat_strength 613
     set %max_stat_dexterity 125
     set %max_stat_intelligence 143
     set %max_resist_physical 65
     set %max_resist_fire 45
     set %max_resist_cold 85
     set %max_resist_poison 50
     set %max_resist_energy 85
     set %max_skill_wrestling 100
     set %max_skill_tactics 100
     set %max_skill_resistance 100
     set %max_skill_anatomy 100
     set %max_skill_poisoning 100
     set %max_skill_magery n/a
     set %max_skill_eval n/a
     set %max_skill_meditation 100

     set %min_stat_hitpoints 505
     set %min_stat_strength 600
     set %min_stat_dexterity 75
     set %min_stat_intelligence 125
     set %min_resist_physical 50
     set %min_resist_fire 25
     set %min_resist_cold 70
     set %min_resist_poison 30
     set %min_resist_energy 70
     set %min_skill_wrestling 93.1
     set %min_skill_tactics 93.1
     set %min_skill_resistance 75.1
     set %min_skill_anatomy 65.1
     set %min_skill_poisoning 80.1
     set %min_skill_magery n/a
     set %min_skill_eval n/a
     set %min_skill_meditation 0
     return
    }
    set %currentpettype 2
    set %name CuSidhe
    set %max_stat_hitpoints 1275
    set %max_stat_strength 1225
    set %max_stat_dexterity 170
    set %max_stat_intelligence 285
    set %max_resist_physical 65
    set %max_resist_fire 45
    set %max_resist_cold 85
    set %max_resist_poison 50
    set %max_resist_energy 85
    set %max_skill_wrestling 100
    set %max_skill_tactics 100
    set %max_skill_resistance 100
    set %max_skill_anatomy 100
    set %max_skill_poisoning 100
    set %max_skill_magery n/a
    set %max_skill_eval n/a
    set %max_skill_meditation 100

    set %min_stat_hitpoints 1010
    set %min_stat_strength 1200
    set %min_stat_dexterity 150
    set %min_stat_intelligence 250
    set %min_resist_physical 50
    set %min_resist_fire 25
    set %min_resist_cold 70
    set %min_resist_poison 30
    set %min_resist_energy 70
    set %min_skill_wrestling 93.1
    set %min_skill_tactics 93.1
    set %min_skill_resistance 75.1
    set %min_skill_anatomy 65.1
    set %min_skill_poisoning 80.1
    set %min_skill_magery n/a
    set %min_skill_eval n/a
    set %min_skill_meditation 0
    return
  }

if #findtype in %GDragon
  {
  display yesno Greater Dragon?$
  set %disp #dispres
   if %disp = NO
   {
    set %tame #true
    set %currentpettype 9
    set %name Dragon
    set %max_stat_hitpoints 495
    set %max_stat_strength 825
    set %max_stat_dexterity 125
    set %max_stat_intelligence 475
    set %max_resist_physical 65
    set %max_resist_fire 70
    set %max_resist_cold 40
    set %max_resist_poison 35
    set %max_resist_energy 45
    set %max_skill_wrestling 100
    set %max_skill_tactics 100
    set %max_skill_resistance 100
    set %max_skill_anatomy 100
    set %max_skill_poisoning n/a
    set %max_skill_magery 100
    set %max_skill_eval 100
    set %max_skill_meditation 100

    set %min_stat_hitpoints 478
    set %min_stat_strength 796
    set %min_stat_dexterity 86
    set %min_stat_intelligence 436
    set %min_resist_physical 55
    set %min_resist_fire 60
    set %min_resist_cold 30
    set %min_resist_poison 25
    set %min_resist_energy 35
    set %min_skill_wrestling 90.1
    set %min_skill_tactics 97.6
    set %min_skill_resistance 99.1
    set %min_skill_anatomy 0
    set %min_skill_poisoning n/a
    set %min_skill_magery 30.1
    set %min_skill_eval 30.1
    set %min_skill_meditation 0
    return
  }
      if %tame = #true && %disp = YES
      {
       set %currentpettype 18
       set %name GreaterDragon
       set %max_stat_hitpoints 1000
       set %max_stat_strength 713
       set %max_stat_dexterity 125
       set %max_stat_intelligence 338
       set %max_resist_physical 85
       set %max_resist_fire 90
       set %max_resist_cold 55
       set %max_resist_poison 60
       set %max_resist_energy 75
       set %max_skill_wrestling 145
       set %max_skill_tactics 140
       set %max_skill_resistance 140
       set %max_skill_anatomy 100
       set %max_skill_poisoning 0
       set %max_skill_magery 140
       set %max_skill_eval 100
       set %max_skill_meditation 0

       set %min_stat_hitpoints 500
       set %min_stat_strength 513
       set %min_stat_dexterity 41
       set %min_stat_intelligence 238
       set %min_resist_physical 60
       set %min_resist_fire 65
       set %min_resist_cold 40
       set %min_resist_poison 40
       set %min_resist_energy 50
       set %min_skill_wrestling 115
       set %min_skill_tactics 110
       set %min_skill_resistance 110
       set %min_skill_anatomy 0
       set %min_skill_poisoning 0
       set %min_skill_magery 110
       set %min_skill_eval 90
       set %min_skill_meditation 0
       return
      }
      if %disp = YES
      {
      set %currentpettype 18
      set %name GreaterDragon
      set %max_stat_hitpoints 2000
      set %max_stat_strength 1425
      set %max_stat_dexterity 148
      set %max_stat_intelligence 675
      set %max_resist_physical 85
      set %max_resist_fire 90
      set %max_resist_cold 55
      set %max_resist_poison 60
      set %max_resist_energy 75
      set %max_skill_wrestling 145
      set %max_skill_tactics 140
      set %max_skill_resistance 140
      set %max_skill_anatomy 100
      set %max_skill_poisoning n/a
      set %max_skill_magery 140
      set %max_skill_eval 110
      set %max_skill_meditation 100

      set %min_stat_hitpoints 1000
      set %min_stat_strength 1025
      set %min_stat_dexterity 81
      set %min_stat_intelligence 475
      set %min_resist_physical 60
      set %min_resist_fire 65
      set %min_resist_cold 40
      set %min_resist_poison 40
      set %min_resist_energy 50
      set %min_skill_wrestling 115
      set %min_skill_tactics 110
      set %min_skill_resistance 110
      set %min_skill_anatomy 0
      set %min_skill_poisoning n/a
      set %min_skill_magery 110
      set %min_skill_eval 90
      set %min_skill_meditation 0
      return
      }
  }

if #findtype in %Hiryu
  {
  if %tame = #true
  {
    set %currentpettype 9
    set %name Hiryu
    set %max_stat_hitpoints 550
    set %max_stat_strength 710
    set %max_stat_dexterity 125
    set %max_stat_intelligence 163
    set %max_resist_physical 70
    set %max_resist_fire 90
    set %max_resist_cold 25
    set %max_resist_poison 50
    set %max_resist_energy 50
    set %max_skill_wrestling 120
    set %max_skill_tactics 110
    set %max_skill_resistance 100
    set %max_skill_anatomy 80
    set %max_skill_poisoning n/a
    set %max_skill_magery n/a
    set %max_skill_eval n/a
    set %max_skill_meditation n/a

    set %min_stat_hitpoints 450
    set %min_stat_strength 600
    set %min_stat_dexterity 85
    set %min_stat_intelligence 150
    set %min_resist_physical 55
    set %min_resist_fire 70
    set %min_resist_cold 15
    set %min_resist_poison 40
    set %min_resist_energy 40
    set %min_skill_wrestling 100
    set %min_skill_tactics 100
    set %min_skill_resistance 85
    set %min_skill_anatomy 75
    set %min_skill_poisoning n/a
    set %min_skill_magery n/a
    set %min_skill_eval n/a
    set %min_skill_meditation n/a
    return
   }
    set %currentpettype 9
    set %name Hiryu
    set %max_stat_hitpoints 1100
    set %max_stat_strength 1420
    set %max_stat_dexterity 270
    set %max_stat_intelligence 325
    set %max_resist_physical 70
    set %max_resist_fire 90
    set %max_resist_cold 25
    set %max_resist_poison 50
    set %max_resist_energy 50
    set %max_skill_wrestling 120
    set %max_skill_tactics 110
    set %max_skill_resistance 100
    set %max_skill_anatomy 80
    set %max_skill_poisoning n/a
    set %max_skill_magery n/a
    set %max_skill_eval n/a
    set %max_skill_meditation n/a

    set %min_stat_hitpoints 900
    set %min_stat_strength 1200
    set %min_stat_dexterity 170
    set %min_stat_intelligence 300
    set %min_resist_physical 55
    set %min_resist_fire 70
    set %min_resist_cold 15
    set %min_resist_poison 40
    set %min_resist_energy 40
    set %min_skill_wrestling 100
    set %min_skill_tactics 100
    set %min_skill_resistance 85
    set %min_skill_anatomy 75
    set %min_skill_poisoning n/a
    set %min_skill_magery n/a
    set %min_skill_eval n/a
    set %min_skill_meditation n/a
    return
  }


if #findtype in %Nightmare
   {
    set %tame #true
    set %currentpettype 12
    set %name Nightmare
    set %max_stat_hitpoints 315
    set %max_stat_strength 525
    set %max_stat_dexterity 125
    set %max_stat_intelligence 125
    set %max_resist_physical 65
    set %max_resist_fire 40
    set %max_resist_cold 40
    set %max_resist_poison 40
    set %max_resist_energy 30
    set %max_skill_wrestling 100
    set %max_skill_tactics 100
    set %max_skill_resistance 100
    set %max_skill_anatomy 100
    set %max_skill_poisoning n/a
    set %max_skill_magery 100
    set %max_skill_eval 100
    set %max_skill_meditation 100

    set %min_stat_hitpoints 298
    set %min_stat_strength 469
    set %min_stat_dexterity 86
    set %min_stat_intelligence 86
    set %min_resist_physical 55
    set %min_resist_fire 30
    set %min_resist_cold 30
    set %min_resist_poison 30
    set %min_resist_energy 20
    set %min_skill_wrestling 80.5
    set %min_skill_tactics 97.6
    set %min_skill_resistance 85.3
    set %min_skill_anatomy 0
    set %min_skill_poisoning n/a
    set %min_skill_magery 10.4
    set %min_skill_eval 10.4
    set %min_skill_meditation 0
    return
  }

  if #findtype in %Reptalon
  {
    if %tame = #true
    {
     set %currentpettype 13
     set %name Reptalon
     set %max_stat_hitpoints 500
     set %max_stat_strength 513
     set %max_stat_dexterity 125
     set %max_stat_intelligence 145
     set %max_resist_physical 65
     set %max_resist_fire 45
     set %max_resist_cold 45
     set %max_resist_poison 65
     set %max_resist_energy 85
     set %max_skill_wrestling 120
     set %max_skill_tactics 107.6
     set %max_skill_resistance 89.8
     set %max_skill_anatomy 59.4
     set %max_skill_poisoning n/a
     set %max_skill_magery n/a
     set %max_skill_eval n/a
     set %max_skill_meditation n/a

     set %min_stat_hitpoints 400
     set %min_stat_strength 500
     set %min_stat_dexterity 75
     set %min_stat_intelligence 125
     set %min_resist_physical 50
     set %min_resist_fire 35
     set %min_resist_cold 35
     set %min_resist_poison 50
     set %min_resist_energy 70
     set %min_skill_wrestling 100.1
     set %min_skill_tactics 100
     set %min_skill_resistance 75.8
     set %min_skill_anatomy 55.2
     set %min_skill_poisoning n/a
     set %min_skill_magery n/a
     set %min_skill_eval n/a
     set %min_skill_meditation n/a
     return
    }
    set %currentpettype 13
    set %name Reptalon
    set %max_stat_hitpoints 1000
    set %max_stat_strength 1025
    set %max_stat_dexterity 170
    set %max_stat_intelligence 290
    set %max_resist_physical 65
    set %max_resist_fire 45
    set %max_resist_cold 45
    set %max_resist_poison 65
    set %max_resist_energy 85
    set %max_skill_wrestling 120
    set %max_skill_tactics 107.6
    set %max_skill_resistance 89.8
    set %max_skill_anatomy 59.4
    set %max_skill_poisoning n/a
    set %max_skill_magery n/a
    set %max_skill_eval n/a
    set %max_skill_meditation n/a

    set %min_stat_hitpoints 800
    set %min_stat_strength 1000
    set %min_stat_dexterity 150
    set %min_stat_intelligence 250
    set %min_resist_physical 50
    set %min_resist_fire 35
    set %min_resist_cold 35
    set %min_resist_poison 50
    set %min_resist_energy 70
    set %min_skill_wrestling 100.1
    set %min_skill_tactics 100
    set %min_skill_resistance 75.8
    set %min_skill_anatomy 55.2
    set %min_skill_poisoning n/a
    set %min_skill_magery n/a
    set %min_skill_eval n/a
    set %min_skill_meditation n/a
    return
  }

  if #findtype in %Rune_Beetle
  {
    set %tame #true
    set %currentpettype 14
    set %name RuneBeetle
    set %max_stat_hitpoints 360
    set %max_stat_strength 465
    set %max_stat_dexterity 170
    set %max_stat_intelligence 450
    set %max_resist_physical 65
    set %max_resist_fire 50
    set %max_resist_cold 50
    set %max_resist_poison 95
    set %max_resist_energy 60
    set %max_skill_wrestling 100
    set %max_skill_tactics 100
    set %max_skill_resistance 110
    set %max_skill_anatomy 100
    set %max_skill_poisoning 140
    set %max_skill_magery 110
    set %max_skill_eval 125
    set %max_skill_meditation 110

    set %min_stat_hitpoints 310
    set %min_stat_strength 400
    set %min_stat_dexterity 125
    set %min_stat_intelligence 375
    set %min_resist_physical 40
    set %min_resist_fire 35
    set %min_resist_cold 35
    set %min_resist_poison 75
    set %min_resist_energy 40
    set %min_skill_wrestling 70
    set %min_skill_tactics 80
    set %min_skill_resistance 95
    set %min_skill_anatomy 0
    set %min_skill_poisoning 120
    set %min_skill_magery 100
    set %min_skill_eval 100
    set %min_skill_meditation 95
    return
  }
if #findtype in %Bake_Kitsune
  {
    set %tame #true
    set %currentpettype 9
    set %name BakeKitsune
    set %max_stat_hitpoints 350
    set %max_stat_strength 220
    set %max_stat_dexterity 145
    set %max_stat_intelligence 425
    set %max_resist_physical 60
    set %max_resist_fire 90
    set %max_resist_cold 60
    set %max_resist_poison 60
    set %max_resist_energy 60
    set %max_skill_wrestling 55
    set %max_skill_tactics 90
    set %max_skill_resistance 100
    set %max_skill_anatomy 100
    set %max_skill_poisoning n/a
    set %max_skill_magery 90
    set %max_skill_eval 90
    set %max_skill_meditation 95

    set %min_stat_hitpoints 310
    set %min_stat_strength 170
    set %min_stat_dexterity 125
    set %min_stat_intelligence 375
    set %min_resist_physical 40
    set %min_resist_fire 70
    set %min_resist_cold 40
    set %min_resist_poison 40
    set %min_resist_energy 40
    set %min_skill_wrestling 50
    set %min_skill_tactics 70
    set %min_skill_resistance 80
    set %min_skill_anatomy 0
    set %min_skill_poisoning n/a
    set %min_skill_magery 80
    set %min_skill_eval 80
    set %min_skill_meditation 85
    return
  }
if #findtype in %White_Wyrm
 {
    set %tame #true
    set %currentpettype 9
    set %name White , #spc , Wyrm
    set %max_stat_hitpoints 455
    set %max_stat_strength 760
    set %max_stat_dexterity 130
    set %max_stat_intelligence 425
    set %max_resist_physical 70
    set %max_resist_fire 25
    set %max_resist_cold 90
    set %max_resist_poison 50
    set %max_resist_energy 50
    set %max_skill_wrestling 100
    set %max_skill_tactics 100
    set %max_skill_resistance 100
    set %max_skill_anatomy 100
    set %max_skill_poisoning 100
    set %max_skill_magery 100
    set %max_skill_eval 100
    set %max_skill_meditation 100

    set %min_stat_hitpoints 433
    set %min_stat_strength 721
    set %min_stat_dexterity 101
    set %min_stat_intelligence 386
    set %min_resist_physical 55
    set %min_resist_fire 15
    set %min_resist_cold 80
    set %min_resist_poison 40
    set %min_resist_energy 40
    set %min_skill_wrestling 90.1
    set %min_skill_tactics 97.6
    set %min_skill_resistance 99.1
    set %min_skill_anatomy 0
    set %min_skill_poisoning 0
    set %min_skill_magery 99.1
    set %min_skill_eval 99.1
    set %min_skill_meditation 0
    return
  }
if #findtype in %Fire_Steed
 {
    set %tame #true
    set %currentpettype 9
    set %name Fire , #spc , Steed
    set %max_stat_hitpoints 240
    set %max_stat_strength 400
    set %max_stat_dexterity 125
    set %max_stat_intelligence 300
    set %max_resist_physical 40
    set %max_resist_fire 80
    set %max_resist_cold 30
    set %max_resist_poison 40
    set %max_resist_energy 40
    set %max_skill_wrestling 100
    set %max_skill_tactics 100
    set %max_skill_resistance 120
    set %max_skill_anatomy 100
    set %max_skill_poisoning n/a
    set %max_skill_magery n/a
    set %max_skill_eval n/a
    set %max_skill_meditation n/a

    set %min_stat_hitpoints 226
    set %min_stat_strength 376
    set %min_stat_dexterity 91
    set %min_stat_intelligence 291
    set %min_resist_physical 30
    set %min_resist_fire 70
    set %min_resist_cold 20
    set %min_resist_poison 30
    set %min_resist_energy 30
    set %min_skill_wrestling 100
    set %min_skill_tactics 100
    set %min_skill_resistance 100
    set %min_skill_anatomy 0
    set %min_skill_poisoning n/a
    set %min_skill_magery n/a
    set %min_skill_eval n/a
    set %min_skill_meditation n/a
    return
  }

sub OffsetClick
  set %tempx %1 + #CONTPOSX
  set %tempy %2 + #CONTPOSY
  click %tempx %tempy %3
return

sub clean_all
  set %total 0.0
  set %stars N/A
  set %max_stat_hitpoints N/A
  set %max_stat_strength N/A
  set %max_stat_dexterity N/A
  set %max_stat_intelligence N/A
  set %max_resist_physical N/A
  set %max_resist_fire N/A
  set %max_resist_cold N/A
  set %max_resist_poison N/A
  set %max_resist_energy N/A
  set %max_skill_wrestling N/A
  set %max_skill_tactics N/A
  set %max_skill_resistance N/A
  set %max_skill_anatomy N/A
  set %max_skill_poisoning N/A
  set %max_skill_magery N/A
  set %max_skill_eval N/A
  set %max_skill_meditation N/A
  set %per_skill_wrestling N/A
  set %per_skill_tactics N/A
  set %per_skill_resistance N/A
  set %per_skill_anatomy N/A
  set %per_skill_poisoning N/A
  set %per_skill_magery N/A
  set %per_skill_eval N/A
  set %per_skill_meditation N/A
  set %sel_stat_hitpoints N/A
  set %sel_stat_strength N/A
  set %sel_stat_dexterity N/A
  set %sel_stat_intelligence N/A
  set %sel_resist_physical N/A
  set %sel_resist_fire N/A
  set %sel_resist_cold N/A
  set %sel_resist_poison N/A
  set %sel_skill_wrestling N/A
  set %sel_skill_tactics N/A
  set %sel_skill_resistance N/A
  set %sel_skill_anatomy N/A
  set %sel_skill_poisoning N/A
  set %sel_skill_magery N/A
  set %sel_skill_meditation N/A
  set %sel_skill_eval N/A
  set %sel_resist_energy N/A
  set %min_stat_hitpoints N/A
  set %min_stat_strength N/A
  set %min_stat_dexterity N/A
  set %min_stat_intelligence N/A
  set %min_resist_physical N/A
  set %min_resist_fire N/A
  set %min_resist_cold N/A
  set %min_resist_poison N/A
  set %min_resist_energy N/A
return

; END
goto SUO
;==================================
; Script Name: Raziel's Floating point math subs
; Author: Raziel
; Version: 1.0
; Client Tested with: N/A
; EUO version tested with: N/A
; Shard OSI / FS: N/A
; Revision Date: N/A
; Public Release: 12/01/2005
; Global Variables Used: N/A
; Purpose: Various subs to help with floating point maths
;==================================
sub divide
  namespace push
  namespace local divide
  set !lpc #lpc
  set #lpc 1000
  set !x %1
  set !y %2
  set !negX #false
  set !negY #false
  str pos !x -
  if #strres <> 0
  {
    str del !x #strres 1
    set !negX #true
    set !x #strres
  }
  str pos !y -
  if #strres <> 0
  {
    str del !y #strres 1
    set !negY #true
    set !y #strres
  }
  set !dp %3
  if %0 < 3
    set !dp 1
  set !multiplyingFactorX 0
  set !multiplyingFactorY 0
  str pos !x #dot
  if #strres <> 0
  {
    set !pos #strres
    str len !x
    set !len #strres
    set !multiplyingFactorX !len - !pos
    str del !x !pos 1
    set !x #strres
  }
  str pos !y #dot
  if #strres <> 0
  {
    set !pos #strres
    str len !y
    set !len #strres
    set !multiplyingFactorY !len - !pos
    str del !y !pos 1
    set !y #strres
  }
  if !multiplyingFactorX > !multiplyingFactorY
  {
    set !difference !multiplyingFactorX - !multiplyingFactorY
    for !i 1 !difference
    {
      set !y !y , 0
    }
    set !multiplyingFactor  !multiplyingFactorX
  }
  if !multiplyingFactorY > !multiplyingFactorX
  {
    set !difference !multiplyingFactorY - !multiplyingFactorX
    for !i 1 !difference
    {
      set !x !x , 0
    }
    set !multiplyingFactor  !multiplyingFactorY
  }
  set !temp !x / !y
  set !x 10 * ( !x % !y )
  set !result !temp
  set !result !result , #dot
  for !i 0 !dp
  {
    set !temp !x / !y
    set !x 10 * ( !x % !y )
    set !result !result , !temp
  }
  
_divideRemove0:
  str right !result 1
  if #strres = 0
  {
    str len !result
    set !len #strres - 1
    str left !result !len
    set !result #strres
    goto _divideRemove0
  }
  set #lpc !lpc
  if ( ( !negX  && ! !negY ) || ( ! !negX && !negY ) )
  {
    str ins !result - 1
    set !result #strres
    
  }
  set #result !result
  namespace pop
return #result
;******************************************************************
sub add
  namespace push
  namespace local add
  set !lpc #lpc
  set #lpc 1000
  set !x %1
  set !y %2
  str pos !x #dot
  if #strres = 0
    set !x !x , #dot
  str pos !y #dot
  if #strres = 0
    set !y !y , #dot
  gosub decimalPlaces !x
  set !xdp #result
  gosub decimalPlaces !y
  set !ydp #result
  set !largest x
  set !smallest y
  if !ydp > !xdp
  {
    set !largest y
    set !smallest x
  }
  set !multx !largest , dp
  set !multx ! . !multx
  set !multy !smallest , dp
  set !multy ! . !multy
  set !mult !multx - !multy
  str len !x
  set !temp #strres - !xdp
  str del !x !temp 1
  set !x #strres
  str len !y
  set !temp #strres - !ydp
  str del !y !temp 1
  set !y #strres
  if !mult > 0
  {
    for !i 1 !mult
    {
      set !temp ! . !smallest
      set !temp !temp , 0
      set ! . !smallest !temp
    }
  }
  set !temp !largest , dp
  set !temp ! . !temp
  set !result !x + !y
  str len !result
  set !pos #strres - !temp + 1
  str ins !result #dot !pos
  set #result #strres
  set #lpc !lpc
  namespace pop
return #result
;******************************************************************
sub subtract
  namespace push
  namespace local subtract
  set !lpc #lpc
  set #lpc 1000
  set !x %1
  set !y %2
  str pos !x #dot
  if #strres = 0
    set !x !x , #dot
  str pos !y #dot
  if #strres = 0
    set !y !y , #dot
  gosub decimalPlaces !x
  set !xdp #result
  gosub decimalPlaces !y
  set !ydp #result
  set !largest x
  set !smallest y
  if !ydp > !xdp
  {
    set !largest y
    set !smallest x
  }
  set !multx !largest , dp
  set !multx ! . !multx
  set !multy !smallest , dp
  set !multy ! . !multy
  set !mult !multx - !multy
  str len !x
  set !temp #strres - !xdp
  str del !x !temp 1
  set !x #strres
  str len !y
  set !temp #strres - !ydp
  str del !y !temp 1
  set !y #strres
  if !mult > 0
  {
    for !i 1 !mult
    {
      set !temp ! . !smallest
      set !temp !temp , 0
      set ! . !smallest !temp
    }
  }
  set !temp !largest , dp
  set !temp ! . !temp
  set !result !x - !y
  str len !result
  set !pos #strres - !temp + 1
  str ins !result #dot !pos
_subAdd0:
  set !result #strres
  str len !result
  set !len #strres
  str pos !result #dot
  set !pos #strres
  if !len - !pos < !temp
  {
    set !pos !pos + 1
    str ins !result 0 !pos
    goto _subAdd0
  }
  set #result !result
  set #lpc !lpc
  namespace pop
return #result
;******************************************************************
sub multiply
  namespace push
  namespace local multiply
  set !x %1
  set !y %2
  gosub divide 1 !y 10
  set !y #result
  gosub divide !x !y 10
  namespace pop
return #result
;******************************************************************
sub decimalPlaces
  namespace push
  namespace local decimalPlaces
  set !number %1
  str len !number
  set !len #strres
  str pos !number #dot
  set !decimalPlace #strres
  set #result !len - !decimalPlace
  namespace pop
return #result
;******************************************************************
sub makeInt
  namespace push
  namespace local makeInt
  set !number %1
  str pos !number #dot
  if #strres = 0
  {
    set #result !number
    namespace pop
    return #result
  }
  set !lpc #lpc
  set #lpc 1000
  set !pos #strres
  str len !number
  set !len #strres
  set !temp !pos - 1
  str left !number !temp
  set !major #strres
  set !temp !len - !pos
  str right !number !temp
  set !minor #strres
_makeIntMinor:
  str len !minor
  if #strres > 1
  {
    set !len #strres
    str right !minor 1
    set !num #strres
    str del !minor !len 1
    set !minor #strres
    if !num > 4
      set !minor !minor + 1
    goto _makeIntMinor
  }
  set #result !major
  if !minor > 4
    set #result !major + 1
  set #lpc !lpc
  namespace pop
return #result

;==================================
; Script Name: filesubs.txt (import version)
; Author: Kal In Ex
; Version: 1.10
; Client Tested with: 4.0.6a
; EUO version tested with: 1.42.009d
; Shard OSI / FS: OSI
; Revision Date: April 11, 2005
; Public Release: November 16, 2004
; Global Variables Used:
; Purpose: writing to files in EUO
; Copyright 2004, 2005 Kal In Ex
;==================================

; subs open, GetOSFileCmd, wipe, fwipe, write and dump
; are all a part of filesubs.txt only use this script
; in its entirety and do not modify it!

sub open ; <identifier> <filename>
	namespace push
	namespace local _filebuffers
	set !_filename %1 , _filename
	set !_buffer %1 , _buffer
	set !_dirop %1 , _dirop
	set ! . !_filename %2
	set ! . !_buffer
	set ! . !_dirop >>
	if !_filesub = n/a
		{
		gosub GetOSFileCmd _
		if #result = command.com
			{
			set !_filesub _filesubsW1
			set !_filecmd command.com
			}
		if #result = cmd.exe
			{
			set !_filesub _filesubsW2
			set !_filecmd cmd.exe
			}
		}
	namespace pop
	return

;==================
;**
;* @name GetOSFileCmd
;* @ver 1.0 9May04
;* @author Roadkill
;* @purpose check the OS and set @%1 to cmd.exe or command.exe if win98/2000xp
;* @params %1 the varname to hold the return command
;* @returns @%1 and #result hold cmd.exe for win2k and xp, or command.exe for 98/me
;* @example call rksubs.txt GetOSFileCmd filecmd
;* @status done
sub GetOSFileCmd
	str Left #osver 1
	set % . %1 cmd.exe
	if #strRes = 1
		set % . %1 command.com
	return % . %1
;==================

sub wipe ; <identifier>
	namespace push
	namespace local _filebuffers
	set !_buffer %1 , _buffer
	set !_dirop %1 , _dirop
	set ! . !_buffer
	set ! . !_dirop >
	namespace pop
	return

sub fwipe ; <identifier>
	namespace push
	namespace local _filebuffers
	set !_filename %1 , _filename
	set !_buffer %1 , _buffer
	set ! . !_buffer
	execute !_filecmd /c type > ! . !_filename
	namespace pop
	return

sub write ; <identifier> <text> <text> <text...>
	namespace push
	namespace local _filebuffers
	if %0 > 2
		{
		for !_ 3 %0
			{
			set %2 %2 , #spc , % . !_
			}
		}
	if !_filesub = _filesubsw1 ; win98 file writing
		{
		str len %2
		for !_ #strres 1
			{
			str mid %2 !_ 1
			if #strres in _<>
				{
				str ins %2 ^ !_
				set %2 #strres
				}
			}
		set !_filename %1 , _filename
		set !_dirop %1 , _dirop
		execute !_filecmd /c echo %2 ! . !_dirop ! . !_filename
		set ! . !_dirop >>
		}
	if !_filesub = _filesubsw2 ; xp file writing
		{
		str len %2
		for !_ #strres 1
			{
			str mid %2 !_ 1
			if #strres in _&|()^<>
				{
				str ins %2 ^ !_
				set %2 #strres
				}
			}
		set !_filename %1 , _filename
		set !_buffer %1 , _buffer
		set !_dirop %1 , _dirop
		str len ! . !_buffer
		set !_ #strres
		str len %2
		if !_ + #strres >= 1900
			{
			execute !_filecmd /c ! . !_buffer
			set ! . !_buffer
			}
		str len ! . !_buffer
		if #strres = 0 || ! . !_dirop = >
			set ! . !_buffer echo , #spc , %2 , #spc , ! . !_dirop , #spc , ! . !_filename
		else
			set ! . !_buffer ! . !_buffer , #spc , && , #spc , echo , #spc , %2 , #spc , ! . !_dirop , #spc , ! . !_filename
		set ! . !_dirop >>
		}
	namespace pop
	return

sub dump ; <identifier>
	namespace push
	namespace local _filebuffers
	set !_filename %1 , _filename
	set !_buffer %1 , _buffer
	str len ! . !_buffer
	if #strres > 0
		{
		execute !_filecmd /c ! . !_buffer
		set ! . !_buffer
		}
	namespace pop
	return
	
sub export
gosub open 1 %txt
 set %wat 1
 set %wat2 100
 for %p 1 45
 {
  set %wat %wat + 1
  menu set Export %wat / %wat2
  wait 5
 }
 gosub wipe 1
 gosub write 1 %name
 gosub write 1 __________________________________________________________________
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |----------------------Pet Power Calculator-----------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |________MIN___PET___MAX______ %total _______MIN___PET___MAX_________|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|---------------------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |----------Hit Points-----------|------------Physical-------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |------- %min_stat_hitpoints - %sel_stat_hitpoints - %max_stat_hitpoints -------|-------- %min_resist_physical -- %sel_resist_physical -- %max_resist_physical ---------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|---------------------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-----------Strength------------|--------------Fire---------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |------- %min_stat_strength - %sel_stat_strength - %max_stat_strength -------|-------- %min_resist_fire -- %sel_resist_fire -- %max_resist_fire ---------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|---------------------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-----------Dexterity-----------|--------------Cold---------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |------- %min_stat_dexterity  -- %sel_stat_dexterity -- %max_stat_dexterity -------|-------- %min_resist_cold -- %sel_resist_cold -- %max_resist_cold ---------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|---------------------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |---------Intelligence----------|-------------Poison--------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |------- %min_stat_intelligence  - %sel_stat_intelligence - %max_stat_intelligence -------|-------- %min_resist_poison -- %sel_resist_poison -- %max_resist_poison ---------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|---------------------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|-------------Energy--------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|-------- %min_resist_energy  -- %sel_resist_energy -- %max_resist_energy ---------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |-------------------------------|---------------------------------|
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 |_______________________________|_________________________________|
 gosub write 1 %name
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 +------------------------+
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 Pet Power Calculator
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 MIN - PET - MAX
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 +------------------------+
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 STARS
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %total
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 HIT POINTS
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_stat_hitpoints - %sel_stat_hitpoints - %max_stat_hitpoints
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 STRENGTH
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_stat_strength - %sel_stat_strength - %max_stat_strength
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 DEXTERITY
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_stat_dexterity  - %sel_stat_dexterity - %max_stat_dexterity
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 INTELLIGENCE
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_stat_intelligence  - %sel_stat_intelligence - %max_stat_intelligence
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 PHYSICAL RESIST
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_resist_physical - %sel_resist_physical - %max_resist_physical
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 FIRE RESIST
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_resist_fire - %sel_resist_fire - %max_resist_fire
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 COLD RESIST
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_resist_cold - %sel_resist_cold - %max_resist_cold
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 POISON RESIST
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_resist_poison - %sel_resist_poison - %max_resist_poison
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 .
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 ENERGY RESIST
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 %min_resist_energy  - %sel_resist_energy - %max_resist_energy
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub write 1 +------------------------+
 set %wat %wat + 1
 menu set Export %wat / %wat2
 gosub dump 1
return
;==================================
; Script Name: FAST OCR to get text information from UO gumps
; Author: Kal In Ex
; Version: 5.11
; Client Tested with: 5.0.2 (Patch 13)
; EUO version tested with: 1.5.74
; Shard OSI / FS: OSI
; Revision Date: March 3, 2007
; Public Release: January 22, 2004
; Purpose: get text information from gumps into EasyUO for scripting
; Copyright: 2004, 2005, 2006, 2007 Kal In Ex
;==================================
sub kalocr.txt
if %0 = n/a 2
	display ok kalocr.txt - this script can not be used directly
	halt
if _ , %1 , _ notin _GetMLQInfo_getRuneName_getBookPage_getPageNumber_getBodInfo_getSOSInfo_getINVInfo_testKalOCR_getQuestInfo_getHagQuestMap_getContextInfo_getLoreInfo_getRuneCount_getChar_getText_setCharFormat_getRunebookCharges_getbodinfo2_getTrackingInfo_getvendorinfo_getcontractinfo_ 2
	display ok kalocr.txt - %1 is not a recognized command
  halt
namespace push
namespace local kalocr
set !lpc #lpc
set #lpc 1000
for !_ 0 %0
{
	set ! . !_ % . !_
}
if !KalOCR_Init = n/a 2
	gosub _setCharFormat Default
	set !KalOCR_Init #true
gosub !1
set #lpc !lpc
namespace pop
if #result = n/a
  return
gosub #result
return

; call kalocr.txt getContractInfo <w> <x> <y>
; call kalocr.txt getVendorInfo <w> <x> <y>
; call kalocr.txt getMLQInfo QuestDescription <x> <y>
; call kalocr.txt getMLQInfo QuestOffer <x> <y>
; call kalocr.txt getMLQInfo QuestList <i> <x> <y>
; call kalocr.txt getRuneName <i> <x> <y> <o>
; call kalocr.txt getBookPage <p> <x> <y> <o>
; call kalocr.txt getPageNumber <p> <x> <y>
; call kalocr.txt getBodInfo <i> <x> <y>
; call kalocr.txt getSOSInfo <x> <y>
; call kalocr.txt getINVInfo <m> <x> <y>
; call kalocr.txt testKalOCR
; call kalocr.txt getQuestInfo <w> <x> <y>
; call kalocr.txt getHagQuestMap <x> <y>
; call kalocr.txt getContextInfo <i> <x> <y>
; call kalocr.txt getLoreInfo <i> <w> <x> <y>
; call kalocr.txt getRuneCount <x> <y>
; call kalocr.txt getChar <x> <y> <o> <c> <t>
; call kalocr.txt getText <x> <y> <o> <c> <t> <e>
; call kalocr.txt setCharFormat <o>
; call kalocr.txt getRunebookCharges <x> <y>
; call kalocr.txt getTrackingInfo <x> <y> <s>

sub GetContractInfo
if !2 = rentalLength
{
set !x !3 + 230
set !y !4 + 95
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = rentalCost
{
set !x !3 + 231
set !y !4 + 116
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = renewLandlord
{
set !x !3 + 230
set !y !4 + 190
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = renewRenter
{
set !x !3 + 230
set !y !4 + 210
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = renewCost
{
set !x !3 + 231
set !y !4 + 251
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
return

sub GetVendorInfo
if !2 = dayspaid
{
set !x !3 + 301
set !y !4 + 36
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = dailycharge
{
set !x !3 + 301
set !y !4 + 59
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = goldheld
{
set !x !3 + 301
set !y !4 + 83
set !_ !y + 5
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 80
}
if !2 = expiration
{
set !x !3 + 39
set !y !4 + 133
set !_ !y + 4
savepix !x !_ 1
gosub %kalocr gettext !x !y = #pixcol number 350
}
return

sub GetQuestObjectives
set !xpos 98 + !3
set !ypos 177 + !4
savepix !xpos !ypos 1

gosub _objective 1
return

sub _objective
set !xpos 98 + !3
set !ypos 172 + !4 ;+ !2 * 21 + !4
for !loop %1 1
{
gosub readtext !xpos !ypos = #pixcol text 50
}
return

; !LimeColor
; !LemonColor
; !WhiteColor
; !BWhiteColor

sub getMLQInfo
if !2 = QuestList
{
set !xpos 98 + !4
set !ypos 119 + !3 * 21 + !5
if !WhiteColor = n/a
gosub _GetMLQTextColor WhiteColor !xpos !ypos
gosub readtext !xpos !ypos = !WhiteColor text 200
}
if !2 = QuestOffer
{
set !xpos 160 + !3
set !ypos 108 + !4
if !LimeColor = n/a
gosub _GetMLQTextColor LimeColor !xpos !ypos
gosub readtext !xpos !ypos = !LimeColor text 200
}
if !2 = QuestDescription
{
set !Description
set !xpos 98 + !3
set !ypos 156 + !4
if !LemonColor = n/a
gosub _GetMLQTextColor LemonColor !xpos !ypos
for !LineIndex 1 10
{
gosub readtext !xpos !ypos = !LemonColor text 300
str len %1
if #strres = 0 || #pixcol = 4294967295
break
set !Description !Description , %1 , $
set !ypos !ypos + 18
}
set %1 !Description
}
if !2 = QuestReward
{
set !xpos 133 + !3
set !ypos 162 + !4
if !LemonColor = n/a
gosub _GetMLQTextColor LemonColor !xpos !ypos
gosub readtext !xpos !ypos = !LemonColor text 150
}
return

sub _getMLQTextColor
namespace push
namespace local _KalTemp
set !x1 %2
set !y1 %3
set !x2 !x1 + 8
set !y2 !y1 + 15
set #result
set !count 0
for !x !x1 !x2
{
for !y !y1 !y2
{
savepix !x !y 1
set ! . #pixcol 1 + ! . #pixcol
if ! . #pixcol > !count
{
set #result #pixcol
set !count ! . #pixcol
}
}
}
namespace clear
namespace pop
set ! . %1 #result
return

sub getTrackingInfo
str pos !4 _
str del !4 1 #strres
set !4 ( #strres / 155 ) - 1
set !tgi_cnt 0
for !_l1 0 !4
{
for !_l2 0 3
{
set !xpos !_l2 * 100 + 20 + !2
set !ypos !_l1 * 155 + 90 + !3
gosub readtext !xpos !ypos in 524288 text 95
str len %1
if #strres > 0 2
	set !tgi_cnt !tgi_cnt + 1
	set !tgi_name . !tgi_cnt %1
}
}
return returnTrackingInfo

sub returnTrackingInfo
namespace copy tgi_* from local kalocr
return

sub getbodinfo2
	set !gbi_type n/a
	set !gbi_item n/a
	set !gbi_quality n/a
	set !gbi_material n/a
	set !gbi_amount n/a
	set !gbi_price n/a
	set !gbi_count n/a
	set !gbi_amount n/a
	for !_ 1 6
		{
		set !gbi_item . !_ n/a
		;set !gbi_amount . !_ n/a
		}

	if !menuTextColor = n/a
		{
		set !xpos !3 + 429
		set !ypos !4 +  77
		savepix !xpos !ypos 1
		set !menuTextColor #pixcol
		set !xpos !3 + 422
		set !ypos !4 + 102
		savepix !xpos !ypos 1
		set !menuNumberColor #pixcol
		}

	set !xpos !3 + 61 ; type
	set !ypos !4 + 64 + ( 32 * !2 )
	gosub readtext !xpos !ypos in !menuTextColor text 34
	str len %2
	if #strres = 0
		goto getBodInfo2_end
	set !gbi_type %1
	set !_endscan 10
	if !gbi_type = small
		set !_endscan !2

	set !xpos !3 + 235 ; quality
	set !ypos !4 + 64 + ( 32 * !2 )
	gosub readtext !xpos !ypos in !menuTextColor text 77
	set !gbi_quality %1

	set !xpos !3 + 316 ; material
	set !ypos !4 + 64 + ( 32 * !2 )
	gosub readtext !xpos !ypos in !menuTextColor text 100
	set !gbi_material %1

	set !xpos !3 + 422 ; amount
	set !ypos !4 + 65 + ( 32 * !2 )
	gosub readtext !xpos !ypos in !menuNumberColor number 70
	set !gbi_amount %1

	set !xpos !3 + 496 ; price
	set !ypos !4 + 65 + ( 32 * !2 )
	gosub readtext !xpos !ypos in !menuNumberColor number 78
	set !gbi_price %1

	set !gbi_count 0
	for !_index !2 !_endscan
		{
		set !xpos !3 + 103 ; item
		set !ypos !4 + 64 + ( 32 * !_index )
		gosub readchar !xpos !ypos in !menuTextColor text
		if #result = #spc
			goto getBodInfo2_end
		set !gbi_count !gbi_count + 1
		gosub readtext !xpos !ypos in !menuTextColor text 129
		set !gbi_item . !gbi_count %1
		set !xpos !3 + 61
		set !ypos !4 + 101 + ( 32 * !_index )
		savepix !xpos !ypos 1
		if !_index <> !2 && #pixcol = !menuTextColor
			set !_index !_endscan
		}
getBodInfo2_end:
	;set !gbi_amount !gbi_amount1
	gosub getBodDesc
	return returnBODInfo2

sub returnBODInfo2
	namespace copy gbi_* from local kalocr
	return

sub getRunebookCharges
	set !x !2 + 220
	set !y !3 +  45
	savepix !x !y 1
	set !y !3 + 40
	gosub readtext !x !y = #pixcol number 17
	set !rbi_charges %1
	set !x !2 + 400
	set !y !3 +  45
	savepix !x !y 1
	set !y !3 + 40
	gosub readtext !x !y = #pixcol number 17
	set !rbi_maxcharges %1
	return returnRunebookCharges

sub returnRunebookCharges
		namespace copy rbi_* from local kalocr
	return

sub getrunename
	; check for empty runeslot
	gosub isRuneSlotEmpty !2 !3 !4
	if #result = #true 2
		set %1
		return
	; offset to rune name text
	set !xorigin ( ( !2 - 1 ) / 8 ) * 160 + !3 + 146
	set !yorigin ( ( !2 - 1 ) % 8 ) * 15 + !4 + 61
	if !0 < 5
		set !5 text
	; get text color
	set !x !3 + 158
	set !y !4 + 26
	savepix !x !y 1
	set !blackColor #pixcol
	set !xextent !xorigin + 118
	set !yextent !yorigin + 16
	for !x !xorigin !xextent
	{
	for !y !yorigin !yextent
	{
	savepix !x !y 1
	if #pixcol = !blackColor 8
		set !x !x + 1
		set !y !y + 1
		savepix !x !y 1
		if #pixcol = !blackColor 2
			set !x !x - 1
			savepix !x !y 1
		set !x !xextent - 7 ; exit loop
		set !y !yextent     ; exit loop
	}
	set !x !x + 7 ; skip spaces
	}
	gosub readtext !xorigin !yorigin = #pixcol !5 118

;	if !_charFormat = OutputMessage 10
;		for !_ 1 1
;			{
;			str pos %1 #spc
;			if #strres > 0 5
;				set !_ #strres
;				str del %1 !_ 1
;				str ins #strres ^_ !_
;				set %1 #strres
;				set !_ 0
;			}
	return

; define how some characters are "returned" by sub ReadChar
sub setCharFormat
	gosub _setCharFormat !2
	return

sub _setCharFormat
if %1 = Default || %0 = 0
{
set !KalOCR_SPC #spc
set !KalOCR_A A
set !KalOCR_B B
set !KalOCR_C C
set !KalOCR_D D
set !KalOCR_E E
set !KalOCR_F F
set !KalOCR_G G
set !KalOCR_H H
set !KalOCR_I I
set !KalOCR_J J
set !KalOCR_K K
set !KalOCR_L L
set !KalOCR_M M
set !KalOCR_N N
set !KalOCR_O O
set !KalOCR_P P
set !KalOCR_Q Q
set !KalOCR_R R
set !KalOCR_S S
set !KalOCR_T T
set !KalOCR_U U
set !KalOCR_V V
set !KalOCR_W W
set !KalOCR_X X
set !KalOCR_Y Y
set !KalOCR_Z Z
}
if %1 = OutputMessage
{
set !KalOCR_A ^A
set !KalOCR_B ^B
set !KalOCR_C ^C
set !KalOCR_D ^D
set !KalOCR_E ^E
set !KalOCR_F ^F
set !KalOCR_G ^G
set !KalOCR_H ^H
set !KalOCR_I ^I
set !KalOCR_J ^J
set !KalOCR_K ^K
set !KalOCR_L ^L
set !KalOCR_M ^M
set !KalOCR_N ^N
set !KalOCR_O ^O
set !KalOCR_P ^P
set !KalOCR_Q ^Q
set !KalOCR_R ^R
set !KalOCR_S ^S
set !KalOCR_T ^T
set !KalOCR_U ^U
set !KalOCR_V ^V
set !KalOCR_W ^W
set !KalOCR_X ^X
set !KalOCR_Y ^Y
set !KalOCR_Z ^Z
}
if %1 = NoSpaces
{
set !KalOCR_SPC _
}
return

sub getChar
	;set !3 !3 - 13
	;set !7 !7 - !2
	gosub readchar !2 !3 !4 !5 !6 !7
	set %2 #result
	return

sub getText
	;set !3 !3 - 13
	;set !7 !7 - !2
	gosub readtext !2 !3 !4 !5 !6 !7
	return

sub getRuneCount
	for !_ 1 16
		{
		gosub isRuneSlotEmpty !_ !2 !3
		if #result = #true 2
			set %1 !_ - 1
			return
		}
	set %1 16
	return

sub isRuneSlotEmpty
	set !xorigin ( ( %1 - 1 ) / 8 ) * 160 + %2 + 146
	set !yorigin ( ( %1 - 1 ) % 8 ) * 15 + %3 + 65
	set !x %2 + 158
	set !y %3 + 26
	savepix !x !y 1
	set !blackColor #pixcol
	savepix !xorigin !yorigin 1
	if #pixcol <> !blackColor
		return #false
	set !xorigin !xorigin - 1
	set !yorigin !yorigin - 4
	for !__ 1 16
		{
		savepix !xorigin !yorigin 1
		if #pixcol = !blackColor
			return #false
		set !yorigin !yorigin + 1
		}
	return #true

sub getLoreInfo
	if !3 = name 4
		set !xorigin !4 + 153
		set !yorigin !5 + 168 + ( !2 - 1 ) * 18
		gosub readtext !xorigin !yorigin in 2701642_2701386 text 128
		set !lore_name %1
	if !3 = value 18
		set !xorigin !4 + 257
		set !yscan !5 + 173 + ( !2 - 1 ) * 18
		set !xmax !4 + 346
		for !_ !xorigin !xmax
			{
			savepix !xorigin !yscan 1
			if _ , #pixcol , _ in _25063_524288_
				set !_ !xmax
			else
				set !xorigin !xorigin + 1
			}
		if !xorigin <= !xmax 4
			set !yorigin !5 + 168 + ( !2 - 1 ) * 18
			set !xmax ( !4 + 355 ) - !xorigin
			gosub readtext !xorigin !yorigin in 25063_524288 number !xmax
			set !lore_value %1
		else
			set !lore_value ---
	return returnLoreInfo

sub returnLoreInfo
		namespace copy lore_* from local kalocr
	return

sub getContextInfo
		set !xorigin !3 + 12
		set !yorigin !4 + 12 + ( !2 * 18 )
		gosub readtext !xorigin !yorigin in 16777215 text 300
	return

sub getHagQuestMap
		set %1 !2 + 24
		set %2 !3 + 31

	; create map "signature"

		savepix !2 !3 1
		if _ , #pixcol , _ in _530473_
			set !col 1
		else
			set !col 0
		set !cnt 0
		set !sig _
		for !_ 0 199
		{
			set !xpos %1 + !_
			set !ypos %2 + !_
			savepix !xpos !ypos 1
			if _ , #pixcol , _ in _530473_ 6
				if !col = 1
					set !cnt !cnt + 1
				else 3
					set !sig !sig , !cnt
					set !cnt 1
					set !col 0
			if _ , #pixcol , _ notin _530473_ 6
				if !col = 0
					set !cnt !cnt + 1
				else 3
					set !sig !sig , !cnt
					set !cnt 1
					set !col 1
		}
		set !sig !sig , !cnt

	; lookup map signature

		if !sig = _414251113751167141710111614762113544
			return 1
		if !sig = _38111111641112233111151518127161611353136512
			return 2
		if !sig = _1523129511114134112517411144571471945
			return 3
		if !sig = _01491111131611712514114244119311122544
			return 4
		if !sig = _511311311323434116141102471111782511213911311311332111421
			return 5
		if !sig = _493214113111351511631110121121214141142215159
			return 6
		if !sig = _511117143223321411131511139111311412
			return 7
		if !sig = _0111116111414110316141412138321431151511121124111285295111351217
			return 8
		if !sig = _1117171683133331711217291191010111311211111151653611
			return 9
		if !sig = _4823211172326331414349
			return 10
		if !sig = _048251131132214181131247111115169
			return 11
		if !sig = _61214313113113111153116211163117118723842
			return 12
		if !sig = _591111121531155714111171881151721144244
			return 13
		if !sig = _9312349111324813122111117113333315311111511
			return 14
		if !sig = _01624131111101133110122121311815311119611152
			return 15
		if !sig = _671357511112321172151441314411384
			return 16
		if !sig = _0221114116111111111124117196211417142
			return 17
		if !sig = _202911131313211131965
			return 18
		if !sig = _146161211219141142414106811
			return 19
		if !sig = _0332262114101111173111127121131352443
			return 20
	return

sub getQuestInfo
		if !2 = objective
		{
			set !que_objective
			set !xorigin !3 + 70
			set !yorigin !4 + 130
			for !getQuestInfo1 1 1
				{
				gosub readchar !xorigin !yorigin in 16756364_16756108 text
				if #result <> #spc 6
					gosub readtext !xorigin !yorigin in 16756364_16756108 text 300
					str len %1
					if #strres > 0 3
						set !que_objective !que_objective , %1 , $
						set !yorigin !yorigin + 18
						set !getQuestInfo1 0
				}
		}
		if !2 = progress
		{
			set !que_progress
			set !xorigin !3 + 70
			set !yorigin !4 + 260
			gosub readchar !xorigin !yorigin in 16756364_16756108 text
			if #result <> #spc 11
				gosub readtext !xorigin !yorigin in 16756364_16756108 text 300
				str len %1
				if #strres > 0 8
					set !que_progress !que_progress , %1 , $
					set !yorigin !yorigin + 18
					gosub readchar !xorigin !yorigin in 16756364 text
					if #result <> #spc 4
						gosub readtext !xorigin !yorigin in 16756364 number 300
						str len %1
						if #strres > 0
							set !que_progress !que_progress , %1 , $
		}
		if !2 = toymaker
		{
			for !CreatureIndex 1 4
			{
				set !xorigin !3 + 70
				set !yorigin !4 + 240 + ( !CreatureIndex * 20 )
				gosub readtext !xorigin !yorigin in 16756364_16756108 text 130
				set !que_creature . !CreatureIndex %1
				set !xorigin !3 + 220
				gosub readtext !xorigin !yorigin in 16756364_16756108 text 130
				set !que_creature . !CreatureIndex !que_creature . !CreatureIndex , : , %1
			}
		}
	return returnQuestInfo

sub returnQuestInfo
		namespace copy que_* from local kalocr
	return

sub testKalOCR
	return kalocr
sub kalOCR
	return kalocr

; -78 -133

sub getINVInfo
		set !xorigin !2 + -78
		set !yorigin !3 + -146
		gosub readtext !xorigin !yorigin in 2177131_148_2177387 text 111
		set !yorigin !yorigin + 18
		set !inv_text %1
		for !getINVInfo1 1 1
			{
			gosub readtext !xorigin !yorigin in 2177131_148_2177387 text 111
			str len %1
			if #strres > 0 3
				set !yorigin !yorigin + 18
				set !inv_text !inv_text , #spc , %1
				set !getINVInfo1 0
			}
		set %1
		set !inv_price
		for !getINVInfo2 1 1
			{
			str len !inv_text
			if #strres > 0 16
				str mid !inv_text #strres 1
				if #strres in 123456789o 4
					if #strres = o
						set !inv_price 0 , !inv_price
					else
						set !inv_price #strres , !inv_price
				if #strres <> #spc 9
					if #strres = o
						set %1 0 , %1
					else
						set %1 #strres , %1
					str len !inv_text
					set #strres #strres - 1
					str mid !inv_text 1 #strres
					set !inv_text #strres
					set !getINVInfo2 0
			}
		set !inv_text !inv_text , %1
	return returnINVInfo

sub returnINVInfo
		namespace copy inv_* from local kalocr
	return

; sextant coordinate info...
; http://uoam.net/geo.html

sub getSOSInfo
		set !xorigin !2 + 35
		set !yorigin !3 + 240
		set !sos_coords
	for !getSOSInfo1 1 1
		{
		gosub readchar !xorigin !yorigin in 524288 number
		if #result <> #spc 3
			set !xorigin !xorigin + %1
			set !sos_coords !sos_coords , #result
			set !getSOSInfo1 0
		}
		set %1 !sos_coords
	; extract and normalize NS
		str pos %1 o
		set #strres #strres - 1
		str left %1 #strres
		set !sos_worldy #strres * 60
		str pos %1 o
		str del %1 1 #strres
		set %1 #strres
		str pos %1 '
		set #strres #strres - 1
		str left %1 #strres
		set !sos_worldy !sos_worldy + #strres
		str pos %1 ,
		str del %1 1 #strres
		set %1 #strres
	; extract and normalize WE
		str pos %1 o
		set #strres #strres - 1
		str left %1 #strres
		set !sos_worldx #strres * 60
		str pos %1 o
		str del %1 1 #strres
		set %1 #strres
		str pos %1 '
		set #strres #strres - 1
		str left %1 #strres
		set !sos_worldx !sos_worldx + #strres
	; convert WE to world position
		set !sos_worldx !sos_worldx , 00000 / 421875
		if w in !sos_coords 3
			set !sos_worldx 1323 - !sos_worldx
			if !sos_worldx < 0
				set !sos_worldx !sos_worldx + 5120
		if e in !sos_coords 3
			set !sos_worldx 1323 + !sos_worldx
			if !sos_worldx >= 5120
				set !sos_worldx !sos_worldx - 5120
	; convert NS to world position
		set !sos_worldy !sos_worldy , 0000000 / 52734375
		if n in !sos_coords 3
			set !sos_worldy 1624 - !sos_worldy
			if !sos_worldy < 0
				set !sos_worldy !sos_worldy + 4096
		if s in !sos_coords 3
			set !sos_worldy 1624 + !sos_worldy
			if !sos_worldy >= 4096
				set !sos_worldy !sos_worldy - 4096
	return returnSOSInfo

sub returnSOSInfo
		namespace copy sos_* from local kalocr
	return

sub getBookPage
		if !2 = left 2
			set !xorigin !3 + 38
			set !yorigin !4 + 32
		if !2 = right 2
			set !xorigin !3 + 224
			set !yorigin !4 + 32
		if !0 < 5
			set !5 text
		set !bookText
		for !_ 0 7
		{
			gosub readtext !xorigin !yorigin in 3223700_3223956 !5 153
			set !bookText !bookText , %1 , $
			set !yorigin !yorigin + 18
		}
		set %1 !bookText
	return

sub getPageNumber
		if !2 = left 3
			set !xorigin !3 + 108
			set !yorigin !4 + 202
			set !yscan !4 + 207
		if !2 = right 3
			set !xorigin !3 + 294
			set !yorigin !4 + 202
			set !yscan !4 + 207
		for !_ 0 7
		{
			savepix !xorigin !yscan 1
			if _ , #pixcol , _ in _3227970_3228226_ 2
				gosub readtext !xorigin !yorigin in 3227970_3228226 number 16
				return
			set !xorigin !xorigin + 1
		}
		set %1
	return

sub getBodInfo
		set !gbi_item n/a
		set !gbi_quality n/a
		set !gbi_material n/a
		set !gbi_amount n/a
		set !gbi_price n/a
		set !gbi_count n/a
		set !gbi_item1 n/a
		set !gbi_item2 n/a
		set !gbi_item3 n/a
		set !gbi_item4 n/a
		set !gbi_item5 n/a
		set !gbi_item6 n/a
		if !menuTextColor = n/a
			{
			set !xpos !3 + 147
			set !ypos !4 +  77
			savepix !xpos !ypos 1
			set !menuTextColor #pixcol
			set !xpos !3 + 422
			set !ypos !4 + 102
			savepix !xpos !ypos 1
			set !menuNumberColor #pixcol
			}
		set !ypos !4 + 64 + ( 32 * !2 )
		gosub getBodType
		if !gbi_type <> n/a
		{
;			gosub getBodItem_safe
			gosub getBodItem
			gosub getBodQuality
			gosub getBodMaterial
			gosub getBodAmount
			gosub getBodPrice
			gosub getLBodInfo
			gosub getBodDesc
		}
	return returnBODInfo

sub returnBODInfo
		namespace copy gbi_* from local kalocr
	return

sub getboddesc
		set !gbi_desc a , #spc , bulk , #spc , order , #spc , deed$
		set !gbi_desc !gbi_desc , blessed$
		set !gbi_desc !gbi_desc , !gbi_type , #spc , bulk , #spc , order$

		if !gbi_material = iron
			set !gbi_desc !gbi_desc , iron , #spc , ingots$
		if !gbi_material = dull , #spc , copper
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = shadow , #spc , iron
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = copper
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = bronze
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = golden
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , gold , #spc , ingots.$
		if !gbi_material = agapite
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = verite
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = valorite
			set !gbi_desc !gbi_desc , all , #spc , items , #spc , must , #spc , be , #spc , made , #spc , with , #spc , !gbi_material , #spc , ingots.$
		if !gbi_material = cloth
			set !gbi_desc !gbi_desc , cloth$
		if !gbi_material = normal , #spc , leather
			set !gbi_desc !gbi_desc , !gbi_material , $
		if !gbi_material = spined , #spc , leather
			set !gbi_desc !gbi_desc , !gbi_material , $
		if !gbi_material = horned , #spc , leather
			set !gbi_desc !gbi_desc , !gbi_material , $
		if !gbi_material = barbed , #spc , leather
			set !gbi_desc !gbi_desc , !gbi_material , $

		; RunUO only material "names"
;		if !gbi_material =

		set !gbi_desc !gbi_desc , !gbi_quality , $
		str pos !gbi_amount /
		set #strres #strres + 1
		str del !gbi_amount 1 #strres
		set !gbi_desc !gbi_desc , amount , #spc , to , #spc , make: , #spc , #strres , $
		for !_ 1 !gbi_count
		{
			set !gbi_desc !gbi_desc , !gbi_item . !_ , : , #spc , 0$
		}
	return

sub getBodType
		set !gbi_type n/a
		set !xpos !3 + 61
		gosub readchar !xpos !ypos in !menuTextColor text
		if #result notin sl
			return #false
		if #result = s
			set !gbi_type small
		if #result = l
			set !gbi_type large
	return #true

sub getBodQuality
		set !gbi_quality n/a
		set !xpos !3 + 235
		gosub readchar !xpos !ypos in !menuTextColor text
		if #result notin en
			return #false
		if #result = e
			set !gbi_quality exceptional
		if #result = n
			set !gbi_quality normal
	return #true

sub getBodMaterial
		set !gbi_material n/a
		set !xpos !3 + 316
		gosub readchar !xpos !ypos in !menuTextColor text
		if #result notin abcdghilnsv ; L is for RunUO "Leather"
			return #false
		if #result = a
			set !gbi_material agapite
		if #result = b 9
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor text
			if #result notin ar
				return #false
			if #result = a
				set !gbi_material barbed , #spc , leather
			if #result = r
				set !gbi_material bronze
			set #result n/a
		if #result = c 9
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor text
			if #result notin lo
				return #false
			if #result = l
				set !gbi_material cloth
			if #result = o
				set !gbi_material copper
			set #result n/a
		if #result = d
			set !gbi_material dull , #spc , copper
		if #result = g
			set !gbi_material golden
		if #result = h
			set !gbi_material horned , #spc , leather
		if #result = i
			set !gbi_material iron
		if #result = l
			set !gbi_material normal , #spc , leather
		if #result = n
			set !gbi_material normal , #spc , leather
		if #result = s 9
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor text
			if #result notin hp
				return #false
			if #result = h
				set !gbi_material shadow , #spc , iron
			if #result = p
				set !gbi_material spined , #spc , leather
			set #result n/a
		if #result = v 9
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor text
			if #result notin ae
				return #false
			if #result = a
				set !gbi_material valorite
			if #result = e
				set !gbi_material verite
			set #result n/a
	return #true

sub getBodItem_safe
		set !gbi_item n/a
		set !xpos !3 + 103
		gosub readtext !xpos !ypos in !menuTextColor text 125
		set !gbi_item %1
		if !gbi_item = buckler
			set !gbi_item !gbi_item , #spc
	return #true

sub getBodItem
		set !gbi_item n/a
		set !xpos !3 + 103
		gosub readchar !xpos !ypos in !menuTextColor
		if #result notin abcdefhjklmnprstvw
			return #false
		if #result = a
			set !gbi_item axe
		if #result = b
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin aoru
				return #false
			if #result = a
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin nrst
					return #false
				if #result = n
					set !gbi_item bandana
				if #result = r
					set !gbi_item bardiche
				if #result = s
					set !gbi_item bascinet
				if #result = t
					set !gbi_item battle , #spc , axe
				set #result n/a
			}
			if #result = o
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin dno
					return #false
				if #result = d
					set !gbi_item body , #spc , sash
				if #result = n
				{
					set !xpos !xpos + %1
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin en
						return #false
					if #result = e
					{
						set !xpos !xpos + %1 + 8 ; ' ' is common
						gosub readchar !xpos !ypos in !menuTextColor
						if #result notin aghl
							return #false
						if #result = a
						{
							set !xpos !xpos + %1 + 6 + 9 ; 'rm' is common
							gosub readchar !xpos !ypos in !menuTextColor
							if #result notin os
								return #false
							if #result = o
								set !gbi_item bone , #spc , armor
							if #result = s
								set !gbi_item bone , #spc , arms
							set #result n/a
						}
						if #result = g
							set !gbi_item bone , #spc , gloves
						if #result = h
							set !gbi_item bone , #spc , helmet
						if #result = l
							set !gbi_item bone , #spc , leggings
						set #result n/a
					}
					if #result = n
						set !gbi_item bonnet
					set #result n/a
				}
				if #result = o
					set !gbi_item boots
				set #result n/a
			}
			if #result = r
			{
				set !xpos !xpos + %1 + 6 ; 'o' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin an
					return #false
				if #result = a
					set !gbi_item broadsword
				if #result = n
					set !gbi_item bronze , #spc , shield
				set #result n/a
			}
			if #result = u
				set !gbi_item buckler , #spc
			set #result n/a
		}
		if #result = c
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin ahlu
				return #false
			if #result = a
				set !gbi_item cap
			if #result = h
			{
				set !xpos !xpos + %1 + 6 + 3 + 6 + 9 + 6 + 3 + 3 + 8 ; 'ainmail ' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin #spc , lt
					return #false
				if #result = #spc
					set !gbi_item chainmail , #spc , #spc , coif
				if #result = l
					set !gbi_item chainmail , #spc , leggings
				if #result = t
					set !gbi_item chainmail , #spc , tunic
				set #result n/a
			}
			if #result = l
			{
				set !xpos !xpos + %1 + 6 ; 'o' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin as
					return #false
				if #result = a
					set !gbi_item cloak
				if #result = s
					set !gbi_item close , #spc , helmet
				set #result n/a
			}
			if #result = u
				set !gbi_item cutlass
			set #result n/a
		}
		if #result = d
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin ao
				return #false
			if #result = a
				set !gbi_item dagger
			if #result = o
			{
				set !xpos !xpos + %1 + 6 + 6 + 3 + 6 ; 'uble' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin #spc , t
					return #false
				if #result = #spc
					set !gbi_item double , #spc , axe
				if #result = t
					set !gbi_item doublet
				set #result n/a
			}
			set #result n/a
		}
		if #result = e
			set !gbi_item executioner's , #spc , axe
		if #result = f
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin aelu
				return #false
			if #result = a
			{
				set !xpos !xpos + %1 + 6 + 6 + 6 + 8 ; 'ncy ' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin ds
					return #false
				if #result = d
					set !gbi_item fancy , #spc , dress
				if #result = s
					set !gbi_item fancy , #spc , shirt
				set #result n/a
			}
			if #result = e
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin am
					return #false
				if #result = a
					set !gbi_item feathered , #spc , hat
				if #result = m
				{
					set !xpos !xpos + %1 + 6 + 3 + 6 + 8 ; 'ale ' is common
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin lp
						return #false
					if #result = l
						set !gbi_item female , #spc , leather , #spc , armor
					if #result = p
						set !gbi_item female , #spc , plate
					set #result n/a
				}
				set #result n/a
			}
			if #result = l
				set !gbi_item floppy , #spc , hat
			if #result = u
				set !gbi_item full , #spc , apron
			set #result n/a
		}
		if #result = h
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin ae
				return #false
			if #result = a
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin lm
					return #false
				if #result = l
				{
					set !xpos !xpos + %1
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin bf
						return #false
					if #result = b
						set !gbi_item halberd
					if #result = f
						set !gbi_item half , #spc , apron
					set #result n/a
				}
				if #result = m
					set !gbi_item hammer , #spc , pick
				set #result n/a
			}
			if #result = e
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin al
					return #false
				if #result = a
					set !gbi_item heater , #spc , shield
				if #result = l
					set !gbi_item helmet
				set #result n/a
			}
			set #result n/a
		}
		if #result = j
		{
			set !xpos !xpos + %1 + 6 + 6 + 6 + 6 + 6 + 8 ; 'ester ' is common
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin hs
				return #false
			if #result = h
				set !gbi_item jester , #spc , hat
			if #result = s
				set !gbi_item jester , #spc , suit
			set #result n/a
		}
		if #result = k
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin air
				return #false
			if #result = a
				set !gbi_item katana
			if #result = i
				set !gbi_item kilt
			if #result = r
				set !gbi_item kryss
			set #result n/a
		}
		if #result = l
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin aeo
				return #false
			if #result = a
				set !gbi_item large , #spc , battle , #spc , axe
			if #result = e
			{
				set !xpos !xpos + %1 + 6 + 6 + 6 + 6 + 6 + 8 ;  'ather ' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin abcglst
					return #false
				if #result = a
					set !gbi_item leather , #spc , armor
				if #result = b
					set !gbi_item leather , #spc , bustier
				if #result = c
					set !gbi_item leather , #spc , cap
				if #result = g
				{
					set !xpos !xpos + %1
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin lo
						return #false
					if #result = l
						set !gbi_item leather , #spc , gloves
					if #result = o
						set !gbi_item leather , #spc , gorget
					set #result n/a
				}
				if #result = l
					set !gbi_item leather , #spc , leggings
				if #result = s
				{
					set !xpos !xpos + %1
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin hkl
						return #false
					if #result = h
						set !gbi_item leather , #spc , shorts
					if #result = k
						set !gbi_item leather , #spc , skirt
					if #result = l
						set !gbi_item leather , #spc , sleeves
					set #result n/a
				}
				if #result = t
					set !gbi_item leather , #spc , tunic
				set #result n/a
			}
			if #result = o
			{
				set !xpos !xpos + %1 + 6 + 6 ; 'ng' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin #spc , s
					return #false
				if #result = #spc
					set !gbi_item long , #spc , pants
				if #result = s
					set !gbi_item longsword
				set #result n/a
			}
		}
		if #result = m
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin ae
				return #false
			if #result = a
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin cu
					return #false
				if #result = c
					set !gbi_item mace
				if #result = u
					set !gbi_item maul
				set #result n/a
			}
			if #result = e
			{
				set !xpos !xpos + %1 + 6 + 6 + 3 + 8 ; 'tal ' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin ks
					return #false
				if #result = k
					set !gbi_item metal , #spc , kite , #spc , shield
				if #result = s
					set !gbi_item metal , #spc , shield
				set #result n/a
			}
			set #result n/a
		}
		if #result = n
			set !gbi_item norse , #spc , helm
		if #result = p
		{
			set !xpos !xpos + %1 + 3 + 6 ; 'la" is common
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin it
				return #false
			if #result = i
				set !gbi_item plain , #spc , dress
			if #result = t
			{
				set !xpos !xpos + %1 + 6 ; 'e' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin #spc , m
					return #false
				if #result = #spc
					set !gbi_item plate , #spc , helm
				if #result = m
				{
					set !xpos !xpos + %1 + 6 + 3 + 3 + 8 ; 'ail ' is common
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin aglt
						return #false
					if #result = a
						set !gbi_item platemail , #spc , arms
					if #result = g
					{
						set !xpos !xpos + %1
						gosub readchar !xpos !ypos in !menuTextColor
						if #result notin lo
							return #false
						if #result = l
							set !gbi_item platemail , #spc , gloves
						if #result = o
							set !gbi_item platemail , #spc , gorget
						set #result n/a
					}
					if #result = l
						set !gbi_item platemail , #spc , legs
					if #result = t
						set !gbi_item platemail , #spc , tunic
					set #result n/a
				}
				set #result n/a
			}
			set #result n/a
		}
		if #result = r
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin io
				return #false
			if #result = i
			{
				set !xpos !xpos + %1 + 6 + 6 + 9 + 6 + 3 + 3 + 8 ; 'ngmail ' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin glst
					return #false
				if #result = g
					set !gbi_item ringmail , #spc , gloves
				if #result = l
					set !gbi_item ringmail , #spc , leggings
				if #result = s
					set !gbi_item ringmail , #spc , sleeves
				if #result = t
					set !gbi_item ringmail , #spc , tunic
				set #result n/a
			}
			if #result = o
				set !gbi_item robe
			set #result n/a
		}
		if #result = s
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin achkptu
				return #false
			if #result = a
				set !gbi_item sandals
			if #result = c
				set !gbi_item scimitar
			if #result = h
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin io
					return #false
				if #result = i
					set !gbi_item shirt
				if #result = o
				{
					set !xpos !xpos + %1
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin er
						return #false
					if #result = e
						set !gbi_item shoes
					if #result = r
					{
						set !xpos !xpos + %1 + 6 + 8 ; 't ' is common
						gosub readchar !xpos !ypos in !menuTextColor
						if #result notin ps
							return #false
						if #result = p
							set !gbi_item short , #spc , pants
						if #result = s
							set !gbi_item short , #spc , spear
						set #result n/a
					}
					set #result n/a
				}
				set #result n/a
			}
			if #result = k
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin iu
					return #false
				if #result = i
					set !gbi_item skirt
				if #result = u
					set !gbi_item skullcap
				set #result n/a
			}
			if #result = p
				set !gbi_item spear
			if #result = t
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin ru
					return #false
				if #result = r
					set !gbi_item straw , #spc , hat
				if #result = u
				{
					set !xpos !xpos + %1 + 6 + 6 + 6 + 6 + 8 ; 'dded ' is common
					gosub readchar !xpos !ypos in !menuTextColor
					if #result notin abglst
						return #false
					if #result = a
						set !gbi_item studded , #spc , armor
					if #result = b
						set !gbi_item studded , #spc , bustier
					if #result = g
					{
						set !xpos !xpos + %1
						gosub readchar !xpos !ypos in !menuTextColor
						if #result notin lo
							return #false
						if #result = l
							set !gbi_item studded , #spc , gloves
						if #result = o
							set !gbi_item studded , #spc , gorget
						set #result n/a
					}
					if #result = l
						set !gbi_item studded , #spc , leggings
					if #result = s
						set !gbi_item studded , #spc , sleeves
					if #result = t
						set !gbi_item studded , #spc , tunic
					set #result n/a
				}
				set #result n/a
			}
			if #result = u
				set !gbi_item surcoat
			set #result n/a
		}
		if #result = t
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin aehruw
				return #false
			if #result = a
				set !gbi_item tall , #spc , straw , #spc , hat
			if #result = e
				set !gbi_item tear , #spc , kite , #spc , shield
			if #result = h
				set !gbi_item thigh , #spc , boots
			if #result = r
				set !gbi_item tricorne , #spc , hat
			if #result = u
				set !gbi_item tunic
			if #result = w
				set !gbi_item two , #spc , handed , #spc , axe
			set #result n/a
		}
		if #result = v
			set !gbi_item viking , #spc , sword
		if #result = w
		{
			set !xpos !xpos + %1
			gosub readchar !xpos !ypos in !menuTextColor
			if #result notin ai
				return #false
			if #result = a
			{
				set !xpos !xpos + %1 + 6 + 8 ; 'r ' is common
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin afhm
					return #false
				if #result = a
					set !gbi_item war , #spc , axe
				if #result = f
					set !gbi_item war , #spc , fork
				if #result = h
					set !gbi_item war , #spc , hammer
				if #result = m
					set !gbi_item war , #spc , mace
				set #result n/a
			}
			if #result = i
			{
				set !xpos !xpos + %1
				gosub readchar !xpos !ypos in !menuTextColor
				if #result notin dz
					return #false
				if #result = d
					set !gbi_item wide-brim , #spc , hat
				if #result = z
					set !gbi_item wizard's , #spc , hat
				set #result n/a
			}
			set #result n/a
		}
	return #true

sub getBodAmount
		set !xpos !3 + 422
		set !yorigin !ypos + 1
		set !cnt 0
		set !gbi_amount
		for !getBodAmount1 1 1
			{
			gosub readchar !xpos !yorigin in !menuNumberColor number
			if #pixcol <> 4294967295
				{
				set !xpos !xpos + %1
				if #result = #spc
					set !cnt !cnt + 1
				if !cnt < 3 2
					set !gbi_amount !gbi_amount , #result
					set !getBodAmount1 0
				}
			}
	return

sub getBodPrice
		set !xpos !3 + 496
		set !yorigin !ypos + 1
		set !cnt 0
		set !gbi_price
		for !getBodPrice1 1 1
			{
			gosub readchar !xpos !yorigin in !menuNumberColor number
			set !cnt !cnt + 1
			set !xpos !xpos + %1
			if #result <> #spc && !cnt < 10 2
				set !gbi_price !gbi_price , #result
				set !getBodPrice1 0
			}
	return

sub getLBodInfo
		set !gbi_count 0
		for !_ 1 6
		{
			set !gbi_item . !_ n/a
		}
		if !gbi_type = small 3
			set !gbi_count 1
			set !gbi_item1 !gbi_item
			return
		if !gbi_item = bandana 5
			set !gbi_count 4
			set !gbi_item1 bandana
			set !gbi_item2 shirt
			set !gbi_item3 skirt
			set !gbi_item4 thigh , #spc , boots
		if !gbi_item = bardiche 3
			set !gbi_count 2
			set !gbi_item1 bardiche
			set !gbi_item2 halberd
		if !gbi_item = bone , #spc , helmet 6
			set !gbi_count 5
			set !gbi_item1 bone , #spc , helmet
			set !gbi_item2 bone , #spc , gloves
			set !gbi_item3 bone , #spc , arms
			set !gbi_item4 bone , #spc , leggings
			set !gbi_item5 bone , #spc , armor
		if !gbi_item = bonnet 5
			set !gbi_count 4
			set !gbi_item1 bonnet
			set !gbi_item2 half , #spc , apron
			set !gbi_item3 fancy , #spc , dress
			set !gbi_item4 sandals
		if !gbi_item = chainmail , #spc , #spc , coif 4
			set !gbi_count 3
			set !gbi_item1 chainmail , #spc , #spc , coif
			set !gbi_item2 chainmail , #spc , leggings
			set !gbi_item3 chainmail , #spc , tunic
		if !gbi_item = cutlass 7
			set !gbi_count 6
			set !gbi_item1 cutlass
			set !gbi_item2 viking , #spc , sword
			set !gbi_item3 longsword
			set !gbi_item4 scimitar
			set !gbi_item5 broadsword
			set !gbi_item6 katana
		if !gbi_item = dagger 6
			set !gbi_count 5
			set !gbi_item1 dagger
			set !gbi_item2 kryss
			set !gbi_item3 war , #spc , fork
			set !gbi_item4 short , #spc , spear
			set !gbi_item5 spear
		if !gbi_item = feathered , #spc , hat 6
			set !gbi_count 5
			set !gbi_item1 feathered , #spc , hat
			set !gbi_item2 surcoat
			set !gbi_item3 fancy , #spc , shirt
			set !gbi_item4 short , #spc , pants
			set !gbi_item5 thigh , #spc , boots
		if !gbi_item = floppy , #spc , hat 5
			set !gbi_count 4
			set !gbi_item1 floppy , #spc , hat
			set !gbi_item2 full , #spc , apron
			set !gbi_item3 plain , #spc , dress
			set !gbi_item4 sandals
		if !gbi_item = jester , #spc , hat 5
			set !gbi_count 4
			set !gbi_item1 jester , #spc , hat
			set !gbi_item2 jester , #spc , suit
			set !gbi_item3 cloak
			set !gbi_item4 shoes
		if !gbi_item = large , #spc , battle , #spc , axe 7
			set !gbi_count 6
			set !gbi_item1 large , #spc , battle , #spc , axe
			set !gbi_item2 double , #spc , axe
			set !gbi_item3 battle , #spc , axe
			set !gbi_item4 two , #spc , handed , #spc , axe
			set !gbi_item5 axe
			set !gbi_item6 executioner's , #spc , axe
		if !gbi_item = leather , #spc , cap 7
			set !gbi_count 6
			set !gbi_item1 leather , #spc , cap
			set !gbi_item2 leather , #spc , gorget
			set !gbi_item3 leather , #spc , gloves
			set !gbi_item4 leather , #spc , sleeves
			set !gbi_item5 leather , #spc , leggings
			set !gbi_item6 leather , #spc , tunic
		if !gbi_item = leather , #spc , skirt 7
			set !gbi_count 6
			set !gbi_item1 leather , #spc , skirt
			set !gbi_item2 leather , #spc , bustier
			set !gbi_item3 leather , #spc , shorts
			set !gbi_item4 female , #spc , leather , #spc , armor
			set !gbi_item5 studded , #spc , bustier
			set !gbi_item6 studded , #spc , armor
		if !gbi_item = mace 7
			set !gbi_count 6
			set !gbi_item1 mace
			set !gbi_item2 maul
			set !gbi_item3 war , #spc , mace
			set !gbi_item4 war , #spc , hammer
			set !gbi_item5 hammer , #spc , pick
			set !gbi_item6 war , #spc , axe
		if !gbi_item = platemail , #spc , gorget 7
			set !gbi_count 6
			set !gbi_item1 platemail , #spc , gorget
			set !gbi_item2 platemail , #spc , gloves
			set !gbi_item3 plate , #spc , helm
			set !gbi_item4 platemail , #spc , arms
			set !gbi_item5 platemail , #spc , legs
			set !gbi_item6 platemail , #spc , tunic
		if !gbi_item = ringmail , #spc , gloves 5
			set !gbi_count 4
			set !gbi_item1 ringmail , #spc , gloves
			set !gbi_item2 ringmail , #spc , sleeves
			set !gbi_item3 ringmail , #spc , leggings
			set !gbi_item4 ringmail , #spc , tunic
		if !gbi_item = sandals 5
			set !gbi_count 4
			set !gbi_item1 sandals
			set !gbi_item2 shoes
			set !gbi_item3 boots
			set !gbi_item4 thigh , #spc , boots
		if !gbi_item = skullcap 5
			set !gbi_count 4
			set !gbi_item1 skullcap
			set !gbi_item2 doublet
			set !gbi_item3 kilt
			set !gbi_item4 shoes
		if !gbi_item = straw , #spc , hat 5
			set !gbi_count 4
			set !gbi_item1 straw , #spc , hat
			set !gbi_item2 tunic
			set !gbi_item3 long , #spc , pants
			set !gbi_item4 boots
		if !gbi_item = studded , #spc , gorget 6
			set !gbi_count 5
			set !gbi_item1 studded , #spc , gorget
			set !gbi_item2 studded , #spc , gloves
			set !gbi_item3 studded , #spc , sleeves
			set !gbi_item4 studded , #spc , leggings
			set !gbi_item5 studded , #spc , tunic
		if !gbi_item = tricorne , #spc , hat 5
			set !gbi_count 4
			set !gbi_item1 tricorne , #spc , hat
			set !gbi_item2 cap
			set !gbi_item3 wide-brim , #spc , hat
			set !gbi_item4 tall , #spc , straw , #spc , hat
		if !gbi_item = wizard's , #spc , hat 5
			set !gbi_count 4
			set !gbi_item1 wizard's , #spc , hat
			set !gbi_item2 body , #spc , sash
			set !gbi_item3 robe
			set !gbi_item4 boots
	return

; %1 = left edge of text
; %2 = base line of text - 13
; %3 = operator such as =, <>, notin and in
; %4 = text colors like 12345_23456_34567 (#pixcol values)
; %5 = number | text
;	on return...
; #result = character
; %1 = character width

; note: since 'O's and ZEROs have the same shape and it is shape that
; sub readchar relies on to recognize text parameter %5 is necessary.
; this allows both characters to be returned but its more like an on/off
; switch as there is no way for this routine to distinguish between them
; you specify "number" to cause it to return ZEROs instead of 'O's

; note: in version 2.00 sub readchar parameters changed

sub readchar
		set %4 _ , %4 , _
		set %7 %2 + 5
		savepix %1 %7 1
		if _ , #pixcol , _ %3 %4 256
			set %7 %2 + 13
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 136
				set %7 %2 + 4
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 98
					set %7 %2 + 3
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 12
						set %7 %2 + 2
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 4
							return [
						set %7 %2 + 15
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 2
							return |
						set %1 4
						return (
					set %6 %1 + 2
					set %7 %2 + 4
					savepix %6 %7 1
					if _ , #pixcol , _ %3 %4 37
						set %6 %1 + 2
						set %7 %2 + 8
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 14
							set %6 %1 + 2
							set %7 %2 + 13
							savepix %6 %7 1
							if _ , #pixcol , _ %3 %4 8
								set %6 %1 + 4
								set %7 %2 + 5
								savepix %6 %7 1
								if _ , #pixcol , _ %3 %4 2
									set %1 8
									return !KalOCR_B
								set %1 7
								return !KalOCR_E
							set %1 7
							return !KalOCR_F
						set %6 %1 + 2
						set %7 %2 + 9
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 8
							set %6 %1 + 2
							set %7 %2 + 10
							savepix %6 %7 1
							if _ , #pixcol , _ %3 %4 2
								set %1 8
								return !KalOCR_R
							set %1 8
							return !KalOCR_P
						set %7 %2 + 7
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 8
							return !KalOCR_D
						set %1 10
						return %
					set %6 %1 + 2
					set %7 %2 + 8
					savepix %6 %7 1
					if _ , #pixcol , _ %3 %4 19
						set %6 %1 + 2
						set %7 %2 + 6
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 7
							set %7 %2 + 7
							savepix %1 %7 1
							if _ , #pixcol , _ %3 %4 2
								set %1 8
								return !KalOCR_N
							set %1 8
							return !KalOCR_X
						set %6 %1 + 2
						set %7 %2 + 9
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 8
							return !KalOCR_K
						set %1 8
						return !KalOCR_H
					set %7 %2 + 11
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 14
						set %6 %1 + 2
						set %7 %2 + 5
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 10
							return !KalOCR_M
						set %6 %1 + 2
						set %7 %2 + 13
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 7
							return !KalOCR_L
						set %1 3
						return !KalOCR_I
					set %1 3
					return !
				set %6 %1 + 2
				set %7 %2 + 11
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 12
					set %7 %2 + 6
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 7
						set %7 %2 + 8
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 6
							return k
						set %1 8
						return 2
					set %1 8
					return >
				set %6 %1 + 2
				set %7 %2 + 8
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 8
					set %6 %1 + 2
					set %7 %2 + 13
					savepix %6 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 6
						return b
					set %1 6
					return h
				set %7 %2 + 7
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 3
					return l
				set %1 3
				return i
			set %7 %2 + 11
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 53
				set %6 %1 + 3
				set %7 %2 + 8
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 22
					set %7 %2 + 7
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 12
						set %7 %2 + 4
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 8
							return 5
						set %7 %2 + 8
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 8
							return !KalOCR_G
						set %1 8
						return !KalOCR_S
					set %7 %2 + 10
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 8
						return 8
					set %1 8
					return 3
				set %6 %1 + 4
				set %7 %2 + 5
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 16
					set %6 %1 + 3
					set %7 %2 + 9
					savepix %6 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 9
						return !KalOCR_Q
					set %6 %1 + 5
					set %7 %2 + 8
					savepix %6 %7 1
					if _ , #pixcol , _ %3 %4 4
						set %1 8
						if %0 = 5 && %5 = number
							return 0
						return !KalOCR_O
					set %1 8
					return !KalOCR_C
				set %7 %2 + 4
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 8
					return !KalOCR_U
				set %1 8
				return 6
			set %6 %1 + 2
			set %7 %2 + 9
			savepix %6 %7 1
			if _ , #pixcol , _ %3 %4 28
				set %7 %2 + 4
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 13
					set %7 %2 + 7
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 8
						set %6 %1 + 6
						set %7 %2 + 4
						savepix %6 %7 1
						if _ , #pixcol , _ %3 %4 2
							set %1 8
							return !KalOCR_V
						set %1 12
						return !KalOCR_W
					set %1 9
					return !KalOCR_Y
				set %7 %2 + 6
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 7
					set %7 %2 + 7
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 8
						return 9
					set %1 7
					return ?
				set %1 4
				return 1
			set %6 %1 + 1
			set %7 %2 + 6
			savepix %6 %7 1
			if _ , #pixcol , _ %3 %4 12
				set %7 %2 + 4
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 7
					set %7 %2 + 6
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 8
						return 4
					set %1 3
					return '
				set %1 9
				return \
			set %7 %2 + 6
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 8
				set %6 %1 + 1
				set %7 %2 + 4
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 3
					return `
				set %1 4
				return "
			set %1 8
			return 7
		set %7 %2 + 9
		savepix %1 %7 1
		if _ , #pixcol , _ %3 %4 124
			set %6 %1 + 4
			set %7 %2 + 13
			savepix %6 %7 1
			if _ , #pixcol , _ %3 %4 61
				set %7 %2 + 8
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 28
					set %7 %2 + 12
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 13
						set %7 %2 + 13
						savepix %1 %7 1
						if _ , #pixcol , _ %3 %4 8
							set %6 %1 + 5
							set %7 %2 + 8
							savepix %6 %7 1
							if _ , #pixcol , _ %3 %4 2
								set %1 9
								return m
							set %1 6
							return n
						set %1 6
						return y
					set %7 %2 + 7
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 12
						return @
					set %7 %2 + 10
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 8
						return w
					set %1 6
					return x
				set %6 %1 + 2
				set %7 %2 + 11
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 7
					set %7 %2 + 10
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 6
						return e
					set %1 8
					return <
				set %6 %1 + 3
				set %7 %2 + 14
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 7
					set %7 %2 + 15
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 6
						return g
					set %1 6
					return q
				set %6 %1 + 3
				set %7 %2 + 5
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 6
					return d
				set %1 6
				return a
			set %7 %2 + 12
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 28
				set %7 %2 + 13
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 12
					set %7 %2 + 6
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 8
						return !KalOCR_A
					set %7 %2 + 14
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 6
						return p
					set %1 6
					return r
				set %7 %2 + 8
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 6
					return u
				set %6 %1 + 3
				set %7 %2 + 11
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 6
					return o
				set %1 6
				return c
			set %7 %2 + 8
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 12
				set %7 %2 + 10
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 7
					set %7 %2 + 11
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 6
						return v
					set %1 10
					return ^
				set %1 7
				return +
			set %7 %2 + 10
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 6
				return s
			set %6 %1 + 1
			set %7 %2 + 4
			savepix %6 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 5
				return {
			set %1 6
			return -
		set %6 %1 + 1
		set %7 %2 + 13
		savepix %6 %7 1
		if _ , #pixcol , _ %3 %4 55
			set %7 %2 + 13
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 24
				set %6 %1 + 1
				set %7 %2 + 11
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 7
					set %7 %2 + 4
					savepix %1 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 8
						return !KalOCR_Z
					set %1 6
					return z
				set %7 %2 + 12
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 8
					set %6 %1 + 1
					set %7 %2 + 14
					savepix %6 %7 1
					if _ , #pixcol , _ %3 %4 2
						set %1 3
						return ,
					set %1 3
					return #dot
				set %1 6
				return j
			set %7 %2 + 11
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 13
				set %7 %2 + 6
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 3
					return #smc
				set %6 %1 + 1
				set %7 %2 + 5
				savepix %6 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 11
					return &
				set %1 8
				return !KalOCR_J
			set %7 %2 + 2
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 4
				return )
			set %7 %2 + 3
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 5
				return }
			set %1 6
			return f
		set %6 %1 + 2
		set %7 %2 + 9
		savepix %6 %7 1
		if _ , #pixcol , _ %3 %4 28
			set %6 %1 + 1
			set %7 %2 + 10
			savepix %6 %7 1
			if _ , #pixcol , _ %3 %4 12
				set %7 %2 + 8
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 6
					return t
				set %7 %2 + 10
				savepix %1 %7 1
				if _ , #pixcol , _ %3 %4 2
					set %1 12
					return #
				set %1 9
				return /
			set %7 %2 + 2
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 5
				return ]
			set %7 %2 + 4
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 7
				return !KalOCR_T
			set %1 9
			return $
		set %6 %1 + 1
		set %7 %2 + 11
		savepix %6 %7 1
		if _ , #pixcol , _ %3 %4 12
			set %7 %2 + 4
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 10
				return *
			set %7 %2 + 6
			savepix %1 %7 1
			if _ , #pixcol , _ %3 %4 2
				set %1 3
				return :
			set %1 6
			return =
		set %7 %2 + 1
		savepix %1 %7 1
		if _ , #pixcol , _ %3 %4 2
			set %1 6
			return ~
		set %7 %2 + 15
		savepix %1 %7 1
		if _ , #pixcol , _ %3 %4 2
			set %1 8
			return _
		set %1 8
		return !KalOCR_SPC

; %1 = xpos
; %2 = ypos
; %3 = operator
; %4 = color(s)
; %5 = number | text | both
; %6 = extent (position beyond %1 to scan for text)
; 	...on return
; %1 = text that was read

; use to read lines of text

sub readtext
set !rt_xpos %1
set !rt_ypos %2
set !rt_op %3
set !rt_color %4
set !rt_mode %5
set !rt_extent !rt_xpos + %6
set !rt_text
while #true
{
gosub readchar !rt_xpos !rt_ypos !rt_op !rt_color !rt_mode
if #pixcol = 4294967295
break
set !rt_xpos !rt_xpos + %1
if !rt_xpos > !rt_extent
break
set !rt_text !rt_text , #result
}
set %1 !rt_text
str len !rt_text
for !Trim #strres 1
{
str mid !rt_text !Trim 1
if #strres <> !KalOCR_SPC
break
}
if !Trim = 0
set !rt_text
str left !rt_text !Trim
set %1 #strres
 return
return
